<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>华南师范大学情绪管理系统</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<style>
  * {
    transition: width 0.5s ease, height 0.5s ease, opacity 0.5s ease, font-size 0.5s ease, font-weight 0.5s ease, border 0.4s ease-in, box-shadow 0.4s ease-in-out, background-color 0.4s ease-out, border-radius 1s ease-in, transform 1s ease-in-out;
    background-repeat: no-repeat;
    background-size: 100% 100%;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }



  li {
    list-style: none;
  }

  @keyframes fadein {
    to {
      opacity: 1;
    }

  }

  @keyframes shake {
    0% {
      transform: translate(0);
    }

    25% {
      transform: translate(-5px);
    }

    50% {
      transform: translate(0);
    }

    75% {
      transform: translate(5px);
    }

    100% {
      transform: translate(0);
    }
  }

  .clickshake {
    animation: shake 0.3s ease-in-out;
  }

  body {
    width: auto;
    height: auto;
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    overflow-x: hidden;
    margin: 0 auto;
    padding: 0;
  }

  #all {
    width: 100%;
    height: 1100px;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
    border: 1px solid red;
    margin-left: 0;
  }

  #left {
    width: 20%;
    height: 90%;
    background-color: #fff;
    border-radius: 15px;



  }

  #left:hover {
    box-shadow: 2px 3px 0 0 #000;
  }

  #leftupimg {
    width: 100%;
    height: 10%;
    /* border: 1px solid red; */
    background-image: url('./src/1.png');
    margin-bottom: 2px;
    background-size: 90% 90%;
    background-position: center;
  }

  #leftupsay {
    width: 100%;
    height: 5%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: "KaiTi";
    font-weight: 600;
    font-size: 35px;
    margin-top: 5px;

  }

  #leftmain {
    margin-top: 50px;
    width: 100%;
    height: 50%;
    /* border: 1px solid red; */
  }

  #leftmainui {
    width: 100%;
    height: 90%;
    background-color: #d2fefe9d;
    display: flex;
    justify-content: space-evenly;
    list-style: none;
    flex-direction: column;
  }

  .leftmainli {
    width: 100%;
    height: 19%;

    display: flex;
    justify-content: center;
    font-size: 20px;
    font-weight: 550;
    align-items: center;
    opacity: 0;
    box-shadow: 0px 0px 0px 0px;
    transition: transform 1s ease-in-out, opacity 0.5s ease-out;
    transform: translate(0, 100%);

  }

  .leftmainli.animate {
    opacity: 1;
    transform: translate(0, 0);
    transition-delay: calc(var(--i)*0.3s);
  }

  .leftmainli:hover {
    background-color: #bcbcbca7;
    box-shadow: 1px 2px 3px 1px #000;
  }

  .leftmainli.leftliafterclick {
    background-color: #71ffde46;
    border-right: 8px solid rgb(40, 255, 187);
  }

  .leftmainlipic {
    width: 15%;
    height: 60%;
    /* border: 1px solid red; */
  }

  .leftmainlisay {
    width: 30%;
    height: 100%;
    display: flex;
    justify-content: space-evenly;
    font-size: 20px;
    font-weight: 550;
    align-items: center;
    /* border: 1px solid red; */
  }

  #leftmainlipic1 {
    background-image: url("./src/2.png");
  }

  #leftmainlipic2 {
    background-image: url("./src/3.png");
  }

  #leftmainlipic3 {
    background-image: url("./src/4.png");
  }

  #leftmainlipic4 {
    background-image: url("./src/5.png");
  }

  #leftmainlipic5 {
    background-image: url("./src/6.png");
  }

  #right {
    width: 75%;
    height: 100%;
    background-color: #fff;
    display: block;
    box-shadow: 0 0 3px 4px #727272;
  }

  #rightfirst,
  #rightsecond,
  #rightthird,
  #rightforth,
  #rightfifth {
    width: 100%;
    height: 100%;
    /* border: 1px solid red; */
    display: none;
    visibility: hidden;
  }

  /* #rightsecond {
  z-index: 2;
}



#rightthird {
  z-index: 3;
}


#rightforth {
  z-index: 4;
}

#rightfifth {
  z-index: 5;
} */




  #rightfirst {
    display: block;
    background: linear-gradient(-145deg, hsla(0, 94%, 67%, 0.557), #5efaff9e, #59089781);
    z-index: 1;
  }

  #rightfirsthead {
    width: 100%;
    height: 10%;
    background-color: #ffffff4c;
    /* border: 1px solid red; */
    display: flex;
    justify-content: space-evenly;
    align-items: center;
  }

  #recently {
    width: 10%;
    height: 100%;
    font-size: 25px;
    font-weight: 780;
    font-family: "KaiTi";
    background-color: #9ef7ff63;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
    flex-direction: column;

    /* border-radius: 12px; */
  }

  #selectday {
    width: 90%;
    height: 30%;
    border-radius: 10px;
    font-size: 25px;
    font-weight: 550;
  }

  #recentlyact {
    width: 60%;
    height: 100%;
    background-color: #ffffff36;
    display: flex;
    flex-direction: column;
    justify-content: space-evenly;
    align-items: center;
    scrollbar-width: unset;
    scrollbar-color: #ce95ffe7;

  }

  .recentlyactivity {
    width: 100%;
    height: 33%;
    background-color: #fff;
    display: flex;
    align-items: center;
    border: 1px solid rgb(40, 255, 187);
  }

  .recentlyactivity:hover {
    background-color: #1b13ffb4;
    color: rgb(255, 250, 240)
  }

  .actimg {
    width: 4.5%;
    aspect-ratio: 1;
    object-fit: cover;
    margin-left: 2%;
  }

  #activitysay {
    font-size: 16px;
    font-weight: 660;
    color: rgb(0, 255, 208);
  }

  #activitysay1 {
    font-size: 16px;
    font-weight: 660;
    color: rgb(255, 72, 0);
  }

  #user {
    width: 30%;
    height: 100%;
    background-color: #cbcbcb;
    border: 1px solid rgba(0, 0, 0, 0.107);
    /* border-radius: 15px; */
    display: flex;
    justify-content: space-evenly;
    flex-direction: column;
    align-items: center;

  }

  #userup {
    width: 90%;
    height: 40%;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
  }

  #userupfirst {
    width: 50%;
    height: 100%;
    background-image: url("./src/12.png");
    background-repeat: no-repeat;
    background-size: auto 100%;
    background-position: left;
    /* border: 1px solid red; */
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 20px;
    font-weight: 520;
    color: #007bff;

  }

  #userupsecond {
    width: 20%;
    height: 100%;
    background-image: url("./src/13.png");
    background-repeat: no-repeat;
    background-size: auto 100%;
  }

  #userupsecond:hover {
    cursor: pointer;
  }




  #userdown {
    width: 100%;
    height: 40%;
  }

  .search-box {
    position: relative;
    width: 90%;
    height: 100%;
    margin: 0 auto;
  }


  .search-input {
    width: 90%;
    height: 100%;
    padding: 0 40px 0 12px;
    font-size: 16px;
    border: 2px solid #ccc;
    border-radius: 20px;
    outline: none;
    transition: border-color 0.3s, box-shadow 0.3s;
  }

  .search-input:focus {
    border-color: #007bff;
    box-shadow: 0 0 6px rgba(0, 123, 255, 0.35);
  }

  .search-icon {
    position: absolute;
    top: 50%;
    right: 12px;
    transform: translateY(-50%);
    color: #aaa;
    cursor: pointer;
    font-size: 18px;
  }

  .search-icon:hover {
    color: #007bff;
  }

  /*头部动画实现*/

  @keyframes slideFromBottom {
    from {
      transform: translateY(100%);
      opacity: 0;
    }

    to {
      transform: translateY(0);
      opacity: 1;
    }
  }


  @keyframes slideFromLeft {
    from {
      transform: translateX(-100%);
      opacity: 0;
    }

    to {
      transform: translateX(0);
      opacity: 1;
    }
  }

  @keyframes slideFromRight {
    from {
      transform: translateX(100%);
      opacity: 0;
    }

    to {
      transform: translateX(0);
      opacity: 1;
    }
  }


  #recently,
  #recentlyact,
  #user {
    animation: slideFromBottom 0.6s ease-out forwards;
    opacity: 0;
  }


  #recently {
    animation-delay: 0.2s;
  }

  #recentlyact {
    animation-delay: 0.4s;
  }

  #user {
    animation-delay: 0.6s;
  }


  #recentlyact .recentlyactivity:nth-child(1) {
    animation: slideFromLeft 0.5s ease-out forwards;
    animation-delay: 0.8s;
    opacity: 0;
  }

  #recentlyact .recentlyactivity:nth-child(2) {
    animation: slideFromRight 0.5s ease-out forwards;
    animation-delay: 1s;
    opacity: 0;
  }

  #recentlyact .recentlyactivity:nth-child(3) {
    animation: slideFromLeft 0.5s ease-out forwards;
    animation-delay: 1.2s;
    opacity: 0;
  }

  /*结束头部动画*/







  #rightfirstmain {
    width: 100%;
    height: 40%;
    /* border: 1px solid red; */
    margin-top: 20px;
    display: flex;
    justify-content: space-evenly;
    background-color: #ffffff9c;
  }

  #rightfirstmainleft {
    width: 62%;
    height: 100%;
    box-shadow: 1px 2px 1px 2px #ccc;
    /* background-color: #9695959c; */
  }

  #rightfirstmainleftchart {
    width: 100%;
    height: auto;
  }

  #rightfirstmainright {
    width: 32%;
    height: 100%;
    background-color: #ffffff54;
  }

  #rightfirstmainrightui {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
    flex-direction: column;
    list-style: none;
  }

  .rightfirstmainrightli {
    width: 90%;
    height: 32%;
    background-color: #ffecb38b;
    border-radius: 15px;
    opacity: 0;
    box-shadow: 1px 2px 1px 2px #787070;
    display: block;
    transform: translate(0, -100%);
    transition: transform .6s ease, opacity .6s ease;
  }

  .rightfirstmainrightli:hover {
    box-shadow: inset 0px 0px 0px 10px #ffffffe6;
    background-color: #6eff5ec8;
  }

  .rightfirstmainrightli.animate {
    opacity: 1;
    transform: translate(0);
    transition-delay: calc(var(--i)*0.15s);
  }

  .firstmainsay,
  .firstmainsayfocus,
  .firstmainsaymath {
    margin: 0;
    width: 100%;
    height: 30%;
    /* border: 1px solid red; */
    display: flex;
    justify-content: center;
    align-items: center;
  }



  .mainsay {
    font-size: 20px;
    font-weight: 500;
  }

  .firstmainsayfocus {
    font-size: 25px;
    font-weight: 650;
    font-variant-numeric: tabular-nums;
  }

  .firstmainsaymath {
    font-size: 20px;
    font-weight: 550;
    background-size: right;
    background-size: auto 100%;
    opacity: 0;
    transition: opacity 1s ease;
  }

  .firstmainsaymath.fade-in {
    opacity: 1;
  }

  #saymath1 {
    background-image: url("./src/8.png");
  }

  #saymath2 {
    background-image: url("./src/7.png");
  }

  #saymath3 {
    background-image: url("./src/9.png");
  }

  #rightfirstchart {
    width: 95%;
    height: 45%;
    margin: 5px auto;
    /* border: 1px solid red; */
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #ffffffa9;
    box-shadow: 2px 2px 2px 2px #ccc;
  }

  #rightfirstchartfirst {
    width: 60%;
    height: 100%;
  }

  #rightfirstchartsecond {
    width: 38%;
    height: 100%;
  }

  h2 {
    text-align: center;
    margin: 0 0 20px;
    color: #333;
  }

  #chartWrapper {
    position: relative;
    width: 100%;
    height: 80%;
  }

  .legend {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
    font-size: 14px;
  }

  .legend-item {
    display: flex;
    align-items: center;
  }

  .legend-color {
    width: 20px;
    height: 3px;
    margin-right: 6px;
  }

  #emotionPie {
    width: 100%;
    height: auto;
  }


  #rightsecond {
    /* display: flex;
  justify-content: center;
  align-items: center; */
    background: linear-gradient(-90deg, #ff26e25e, #4022e851, #e8ff1d51);
  }

  #rightsecondhead {
    width: 100%;
    height: 14%;
    /* border: 1px solid red; */
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  #secondheadleft {
    height: 100%;
    width: 65%;
    /* border: 1px solid red; */
    display: flex;
    justify-content: space-between;
  }

  #secondheadleftfirst {
    display: flex;
    justify-content: space-evenly;
    flex-direction: column;
    align-items: center;
  }

  #user1 {
    width: 35%;
    height: 100%;
    background-color: #cbcbcb;
    border: 1px solid rgba(0, 0, 0, 0.107);
    /* border-radius: 15px; */
    display: flex;
    justify-content: space-evenly;
    flex-direction: column;
    align-items: center;
  }

  #rightsecondmain {
    width: 100%;
    height: 60%;
    /* border: 1px solid red; */
    background-color: #ffffff49;
    margin: auto 0;
    margin-top: 15px;
    padding-top: 15px;
  }

  #emotionhistory {
    width: 100%;
    height: 100%;
    /* border: 1px solid red */
  }

  #rightsecondmainhead {
    width: 100%;
    height: 10%;
    display: flex;
    justify-content: space-evenly;
    align-items: center;

  }

  .secondmainheadli {
    width: 25%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 20px;
    font-weight: 550;

  }

  #secondmainheadlifirst {
    background-color: #43fff2;
  }

  .secondmainheadli:hover {
    cursor: pointer;
    background-color: #adadad8c;
    color: #007bff;
    box-shadow: 1px 2px 1px 2px #007bff;
  }

  .secondmainheadli:active {
    background-color: #43fff2;
    color: #007bff;
    box-shadow: inset 0px 0px 0px 5px #007bff77;
  }

  #secondmainmain {
    width: 95%;
    height: 80%;
    background-color: #d8ff9e71;
    /* border: 1px solid red; */
    margin: 10px auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  #secondmainleft {
    width: 60%;
    height: 90%;
    background-color: #fff;
    border-radius: 15px;
    /* border: 1px solid red; */

  }

  #secondmainright {
    width: 35%;
    height: 90%;
    background-color: #fff;
    border-radius: 15px;
    /* border: 1px solid red; */
  }

  .secondmainleftsay {
    margin: 0 auto;
    width: 90%;
    height: 20%;
    /* border: 1px solid red; */
    font-size: 15px;
    font-weight: 550;
    color: #43fff2;
  }

  .secondmainleftsaysay {
    margin: 2px auto;
    width: 100%;
    height: 30%;
    /* border: 1px solid red; */
    display: flex;
    align-items: center;
  }

  #test {
    width: 80%;
    height: 60%;
    /* border: 1px solid red; */
    margin: 5px auto;
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 10px auto;
  }


  #testup.dragover {
    background-color: #ccc;
    /* 拖拽时变灰 */
  }

  #testup {

    width: 100%;
    height: 100%;
    border: 7px dashed rgb(160, 160, 160);
    background-image: url("./src/16.png");
    background-repeat: no-repeat;
    background-size: 100% 100%;
  }

  #testup:hover {
    border: 7px dashed rgb(102, 242, 255);
  }

  #testin {
    width: 100%;
    height: 100%;
    opacity: 0;
  }

  #secondmainbottom {
    margin: 0 auto;
    width: 80%;
    height: 8%;
    font-size: 20px;
    font-weight: 600;
    font-family: "KaiTi";
    color: #000;
    margin-top: 40px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    /* border: 1px solid red; */

  }

  #secondmainbutton {
    width: 20%;
    height: 100%;
    background-color: #fff;
    border: 0px solid white;
    box-shadow: 0px 0px 0px 0px #000;
    font-size: 20px;
    font-weight: 700;
  }

  #secondmainbutton:hover {
    background-color: #9e9e9e;
    border-left: 2px solid black;
    border-right: 2px solid black;
    box-shadow: 1px 2px 2px 1px #000;
  }

  #secondmainbutton:active {
    background-color: #fff;
    box-shadow: inset 0 1px 0 2px #c6c4c4;
  }

  #secondmainrighttitle {
    width: 80%;
    height: 15%;
    margin: 5px auto;
    font-size: 35px;
    font-weight: 600;
    /* border: 1px solid red; */
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* 标题说明 */
  .progress-title {
    font-size: 18px;
    font-weight: 600;
    text-align: center;
    margin-bottom: 6px;
    color: #444;
  }

  /* 状态文字（进度条中间） */
  .progress-text {
    position: absolute;
    width: 100%;
    text-align: center;
    top: 50%;
    transform: translateY(-50%);
    font-size: 14px;
    font-weight: 600;
    color: #333;
  }

  /* 显示结果按钮样式 */
  #showresultbtn {
    display: none;
    margin: 20px auto;
    width: 50%;
    height: 20%;
    background-color: #bcbcbc;
    color: #000;
    font-size: 30px;
    font-weight: 600;
    border: none;
    border-radius: 8px;
    text-align: center;
    line-height: 50px;
    cursor: pointer;
  }

  #showresultbtn:hover {
    width: 51%;
    height: 21%;
    background-color: #2bfff434;
    border: 2px solid #ccc;
    box-shadow: 1px 1px 1px 2px #333;
  }

  /*第二页入场动画*/
  /* 通用淡入滑动动画 */
  @keyframes slide-up {
    from {
      opacity: 0;
      transform: translateY(85%);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slide-down {
    from {
      opacity: 0;
      transform: translateY(-50%);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slide-from-left {
    from {
      opacity: 0;
      transform: translateX(-100%);
    }

    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes slide-from-right {
    from {
      opacity: 0;
      transform: translateX(100%);
    }

    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes progress-rise {
    from {
      opacity: 0;
      transform: translateY(100%);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* 应用的类 */
  .animate-slide-up {
    animation: slide-up 0.8s ease forwards;
  }

  .animate-slide-down {
    animation: slide-down 0.8s ease forwards;
  }

  .animate-from-left {
    animation: slide-from-left 0.8s ease forwards;
  }

  .animate-from-right {
    animation: slide-from-right 0.8s ease forwards;
  }

  .animate-rise {
    animation: progress-rise 0.6s ease forwards;
  }









  /*第三个*/
  .thirdbox {
    width: 50%;
    height: 50%;
    box-sizing: border-box;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* 鼠标悬停时显示四角边框 */
  .thirdbox:hover .thirdcorner,
  .thirdbox:hover::before,
  .thirdbox:hover::after {
    display: block;
  }

  .thirdbox::before,
  .thirdbox::after {
    display: none;
  }

  .thirdcorner {
    width: 10%;
    height: 10%;
    position: absolute;
    border: 3px solid #6c63ff;
    box-sizing: border-box;
    display: none;
  }

  .thirdcorner.topleft {
    top: 0;
    left: 0;
    border-right: none;
    border-bottom: none;
  }

  .thirdcorner.topright {
    top: 0;
    right: 0;
    border-left: none;
    border-bottom: none;
  }

  .thirdcorner.bottomleft {
    bottom: 0;
    left: 0;
    border-right: none;
    border-top: none;
  }

  .thirdcorner.bottomright {
    bottom: 0;
    right: 0;
    border-left: none;
    border-top: none;
  }

  /* 菱形按钮四块 */
  .thirddiamondbtn {
    width: 50%;
    height: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    border: 1px solid #ccc;
    cursor: pointer;
    font-weight: bold;
  }

  .thirddiamondbtn:hover {
    background-color: #a9a9a9;
    box-shadow: 1px 2px #1D4ED8;
    transform: rotate(360deg);
  }

  .thirddiamondbtn:active {
    box-shadow: 1px 2px #1D4ED8;
    transform: rotate(360deg);

  }

  .thirdpage {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: white;
    display: none;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    z-index: 20;
    padding-top: 5%;
  }

  .thirdbackbtn {
    position: absolute;
    top: 3%;
    left: 3%;
    width: 15%;
    height: 6%;
    font-size: 1.2vw;
    background-color: #6c63ff;
    color: white;
    border: none;
    border-radius: 1vw;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #smallsent:hover {
    background-color: #92e4ff !important;
    box-shadow: 1px 2px 0 0 #000;
    border: 2px solid black;
  }

  /* 总体页面背景优化 */
  body {
    background-color: #f7f6f9;
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    padding: 0;
    color: #333;
  }

  /* 卡片通用 */
  .thirdbox {
    /* background-color: #ffffff; */
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    border-radius: 12px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }

  /* 卡片hover效果（总目录页的小盒子） */
  .thirdbox:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    cursor: pointer;
  }

  /* 聊天气泡 */
  .thirdbubble {
    max-width: 70%;
    padding: 10px 14px;
    margin: 8px 0;
    border-radius: 20px;
    font-size: 0.95em;
    line-height: 1.4;
    word-break: break-word;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
  }

  /* 用户和AI气泡颜色 */
  .thirdbubble.user {
    background-color: #dff7e1;
    align-self: flex-end;
  }

  .thirdbubble.ai {
    background-color: #f0f0f0;
    align-self: flex-start;
  }

  /* 头像圆形化 */
  .thirdavatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    margin: 0 10px;
  }

  /* 聊天主界面滚动容器 */
  .thirdchatcontent {
    display: flex;
    flex-direction: column;
    padding: 15px;
    overflow-y: auto;
    height: 70%;
    background-color: #fcfcfc;
    border: 1px solid #e0e0e0;
    border-radius: 10px;
  }

  /* 输入区域 */
  .thirdchatinputbar {
    display: flex;
    gap: 10px;
    margin-top: 10px;
    padding: 8px;
    background-color: #fff;
    border-top: 1px solid #ccc;
    align-items: center;
  }

  /* 文本输入框 */
  .thirdchatinputbar input[type="text"] {
    flex: 1;
    padding: 10px;
    border-radius: 20px;
    border: 1px solid #ccc;
    outline: none;
    transition: border-color 0.3s;

  }

  .thirdchatinputbar input[type="text"]:focus {
    border-color: #8e9aff;
  }

  #thirdfirsttext {
    width: 80%;
  }

  /* 发送按钮 */
  .thirdsendbutton {
    padding: 8px 16px;
    background-color: #8e9aff;
    color: white;
    border: none;
    border-radius: 20px;
    transition: background-color 0.3s;
  }

  .thirdsendbutton:hover {
    background-color: #6d7dff;
    cursor: pointer;
  }

  .thirdsendbutton:active {
    background-color: #5564d8;
  }

  /* 更多功能按钮 */
  .thirdmorebtn {
    background: none;
    border: none;
    font-size: 1.2em;
    color: #666;
    cursor: pointer;
    transition: color 0.2s;
  }

  .thirdmorebtn:hover {
    color: #333;
  }

  /* 顶部标题 */
  .thirdchattitle {
    text-align: center;
    padding: 10px;
    font-size: 1.6em;
    font-weight: bold;
    color: #4a4a4a;
    border-bottom: 1px solid #ddd;
  }



  .thirdbackbtn:hover {
    background-color: #ff9dea;
    cursor: pointer;
  }

  .thirdbackbtn:active {
    background-color: #c4c4c4;
  }



  /*第三个的睡眠*/

  /* 小窗口模式 */
  .third-small-mode {
    width: 90%;
    max-width: 500px;
    margin: 5% auto;
    padding: 5%;
    background-color: white;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  }

  .third-title {
    text-align: center;
    margin-bottom: 10%;
    color: #4a6fa5;
  }

  .third-bubbles-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 10%;
  }

  .third-bubble {
    aspect-ratio: 1/1;
    border-radius: 50%;
    background: linear-gradient(135deg, #6e8efb, #a777e3);
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    font-size: 1.2rem;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }

  .third-bubble:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
  }

  /* 全屏模式 */
  .third-fullscreen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: white;
    padding: 5%;
    overflow-y: auto;
    z-index: 100;
  }

  .third-back-button {
    background: none;
    border: none;
    font-size: 1.2rem;
    color: #4a6fa5;
    cursor: pointer;
    margin-bottom: 5%;
    padding: 1% 2%;
  }

  .third-back-button:hover {
    text-decoration: underline;
  }

  /* 专注睡眠页面 */
  .third-focus-sleep-container {
    display: flex;
    height: 80%;
  }

  .third-timer-section {
    width: 65%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }

  .third-timer-display {
    font-size: 4rem;
    font-family: 'Courier New', monospace;
    margin-bottom: 10%;
    color: #333;
  }

  .third-timer-controls {
    display: flex;
    gap: 5%;
    width: 100%;
    justify-content: center;
  }

  .third-timer-button {
    padding: 3% 6%;
    border: none;
    border-radius: 5px;
    font-size: 1.1rem;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  #third-start-timer {
    background-color: #4CAF50;
    color: white;
  }

  #third-stop-timer {
    background-color: #f44336;
    color: white;
  }

  #third-submit-timer {
    background-color: #2196F3;
    color: white;
  }

  .third-timer-button:hover {
    opacity: 0.9;
  }

  .third-progress-section {
    width: 30%;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .third-progress-container {
    height: 70%;
    width: 30px;
    background-color: #eee;
    border-radius: 15px;
    position: relative;
    margin-bottom: 10%;
  }

  .third-progress-bar {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 0%;
    background: linear-gradient(to top, #ff0000, #ff8000, #00ffff, #0000ff, #00ff00);
    border-radius: 15px;
    transition: height 2.5s ease-in-out;
  }

  .third-progress-labels {
    height: 70%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    margin-left: 40px;
    font-size: 0.9rem;
  }

  .third-rating-display {
    font-size: 1.2rem;
    font-weight: bold;
    color: #4a6fa5;
    margin-top: 10%;
  }

  /* 略微小憩页面 */
  .third-nap-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 80%;
    justify-content: center;
  }

  .third-nap-container h2 {
    font-size: 2rem;
    color: #4a6fa5;
    margin-bottom: 10%;
  }

  .third-nap-timer-display {
    font-size: 3rem;
    margin-bottom: 10%;
    font-family: 'Courier New', monospace;
  }

  .third-nap-slider-container {
    width: 80%;
    margin-bottom: 10%;
  }

  .third-nap-slider {
    width: 100%;
    height: 50px;
    background-color: #eee;
    border-radius: 25px;
    position: relative;
    cursor: pointer;
  }

  .third-nap-slider-handle {
    position: absolute;
    width: 50px;
    height: 50px;
    background-color: #4a6fa5;
    border-radius: 50%;
    top: 0;
    left: calc(50% - 25px);
    transition: left 0.2s;
  }

  .third-nap-start-button {
    padding: 3% 8%;
    background-color: #4a6fa5;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 1.2rem;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  .third-nap-start-button:hover {
    background-color: #3a5a80;
  }

  /* AMSR页面 */
  .third-amsr-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 80%;
    justify-content: center;
  }

  .third-amsr-cover {
    width: 200px;
    height: 200px;
    background-color: #eee;
    margin-bottom: 5%;
    border-radius: 10px;
    overflow: hidden;
  }

  .third-amsr-cover-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .third-amsr-title {
    font-size: 1.5rem;
    margin-bottom: 5%;
    color: #333;
  }

  .third-amsr-progress-container {
    width: 80%;
    margin-bottom: 5%;
  }

  .third-amsr-progress-bar {
    width: 100%;
    height: 5px;
    background-color: #eee;
    border-radius: 3px;
    cursor: pointer;
  }

  .third-amsr-progress {
    width: 0%;
    height: 100%;
    background-color: #4a6fa5;
    border-radius: 3px;
  }

  .third-amsr-controls {
    display: flex;
    gap: 10%;
    margin-top: 5%;
    width: 20%;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
  }

  .third-amsr-button {
    padding: 3% 6%;
    background-color: #4a6fa5;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  .third-amsr-button:hover {
    background-color: #3a5a80;
  }

  /* 睡眠总结页面 */
  .third-summary-container {
    height: 80%;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .third-summary-container h2 {
    font-size: 2rem;
    color: #4a6fa5;
    margin-bottom: 5%;
  }

  .third-chart-container {
    width: 90%;
    height: 80%;
  }

  /* 响应式设计 */
  @media (max-width: 768px) {
    .third-focus-sleep-container {
      flex-direction: column;
      align-items: center;
    }

    .third-timer-section,
    .third-progress-section {
      width: 100%;
    }

    .third-progress-container {
      height: 200px;
      width: 80%;
      margin: 5% 0;
    }

    .third-progress-labels {
      flex-direction: row;
      height: auto;
      width: 100%;
      margin-left: 0;
      margin-top: 10px;
      justify-content: space-between;
    }

    .third-bubbles-container {
      grid-template-columns: 1fr;
      grid-gap: 5%;
    }

    .third-bubble {
      margin-bottom: 5%;
    }
  }

  .third-back-button {
    border: 1px solid rgb(0, 0, 0);
    background-color: #93a3ff;
  }

  .third-back-button:hover {
    background-color: #9a9a9a;
  }

  #thirdsleep {
    background-repeat: no-repeat;
    background-position: center;
    background-size: 100% 80%;
  }

  .thirddream {
    width: 100px;
    height: 20px;
    font-size: 20px;
    font-weight: 550;
  }



  /*第三页静坐*/
  @keyframes gradientBG {
    0% {
      background-position: 0% 50%;
    }

    50% {
      background-position: 100% 50%;
    }

    100% {
      background-position: 0% 50%;
    }
  }

  .thirdsitcontainer {
    width: 95%;
    height: 90%;
    background: rgba(15, 20, 35, 0.92);
    border-radius: 20px;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.6);
    display: flex;
    overflow: hidden;
    backdrop-filter: blur(12px);
    border: 1px solid rgba(100, 150, 255, 0.2);
    transform-style: preserve-3d;
    animation: float 8s ease-in-out infinite;
  }

  @keyframes float {

    0%,
    100% {
      transform: translateY(0) rotateX(1deg) rotateY(1deg);
    }

    50% {
      transform: translateY(-15px) rotateX(-1deg) rotateY(-1deg);
    }
  }

  .thirdsitleftpanel {
    width: 15%;
    height: 50%;
    background: rgba(30, 40, 70, 0.85);
    border-radius: 16px;
    margin: auto 1%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 2%;
    box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.4);
    border: 1px solid rgba(80, 130, 255, 0.15);
    transform: translateZ(20px);
  }

  .thirdsitrightpanel {
    width: 80%;
    height: 98%;
    margin: auto;
    display: flex;
    flex-direction: column;
    transform: translateZ(10px);
  }

  .thirdsitmainarea {
    height: 70%;
    background: rgba(20, 30, 50, 0.75);
    border-radius: 18px;
    margin-bottom: 2%;
    padding: 2%;
    overflow-y: auto;
    box-shadow: inset 0 0 15px rgba(0, 10, 30, 0.7);
    display: flex;
    flex-direction: column;
    gap: 2%;
    border: 1px solid rgba(70, 120, 220, 0.2);
  }

  .thirdsittimerarea {
    height: 28%;
    background: rgba(20, 30, 50, 0.75);
    border-radius: 18px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 2%;
    box-shadow: inset 0 0 15px rgba(0, 10, 30, 0.7);
    border: 1px solid rgba(70, 120, 220, 0.2);
  }

  .thirdsitbtn {
    width: 100%;
    height: 18%;
    background: linear-gradient(to bottom, #3a6bc8, #2a5ab8);
    border: none;
    border-radius: 12px;
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    outline: none;
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    font-size: 1.1vw;
    position: relative;
    overflow: hidden;
    z-index: 1;
    margin-top: 10px;
  }

  .thirdsitbtn::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to bottom, #4a7bd8, #3a6bc8);
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: -1;
  }

  .thirdsitbtn:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
  }

  .thirdsitbtn:hover::before {
    opacity: 1;
  }

  .thirdsitbtn:active {
    transform: translateY(2px);
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
  }

  .thirdsitbtn.addremove {
    background: linear-gradient(to bottom, #32a067, #228f56);
  }

  .thirdsitbtn.addremove::before {
    background: linear-gradient(to bottom, #42b077, #32a067);
  }

  .thirdsitfeature {
    width: 100%;
    height: 15%;
    background: rgba(55, 95, 235, 0.3);
    border-radius: 12px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: 600;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    transition: all 0.4s ease;
    animation: featureAppear 0.6s ease-out;
    border: 1px solid rgba(100, 150, 255, 0.3);
    backdrop-filter: blur(5px);
    font-size: 1.4vw;
    text-shadow: 0 0 10px rgba(100, 200, 255, 0.5);
  }

  @keyframes featureAppear {
    0% {
      opacity: 0;
      transform: translateY(30px) scale(0.9);
    }

    100% {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  .thirdsittimerdisplay {
    font-size: 5vw;
    font-weight: 700;
    letter-spacing: 3px;
    margin-bottom: 3%;
    text-shadow: 0 0 20px rgba(80, 180, 255, 0.8);
    background: linear-gradient(to right, #8ac6ff, #b8e1ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-family: 'Arial Rounded MT Bold', 'Segoe UI', sans-serif;
    animation: pulse 2s infinite;
  }

  @keyframes pulse {

    0%,
    100% {
      text-shadow: 0 0 20px rgba(80, 180, 255, 0.8);
    }

    50% {
      text-shadow: 0 0 30px rgba(100, 200, 255, 1);
    }
  }

  .thirdsitprogresscontainer {
    width: 90%;
    height: 25%;
    background: rgba(40, 50, 80, 0.7);
    border-radius: 15px;
    overflow: hidden;
    box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(90, 140, 240, 0.2);
  }

  .thirdsitprogressbar {
    height: 100%;
    width: 0%;
    background: linear-gradient(to right, #5aa5ff, #7a6af9);
    border-radius: 15px;
    transition: width 0.5s ease;
    box-shadow: 0 0 25px rgba(90, 165, 255, 0.6);
  }

  /* 自定义滚动条 */
  .thirdsitmainarea::-webkit-scrollbar {
    width: 12px;
  }

  .thirdsitmainarea::-webkit-scrollbar-track {
    background: rgba(30, 40, 70, 0.6);
    border-radius: 10px;
  }

  .thirdsitmainarea::-webkit-scrollbar-thumb {
    background: linear-gradient(to bottom, #4a7bd8, #3a6bc8);
    border-radius: 10px;
    border: 2px solid rgba(30, 40, 70, 0.8);
  }

  .thirdsitmainarea::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(to bottom, #5b8be8, #4a7bd8);
  }

  .thirdsitnotification {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(20, 30, 50, 0.95);
    padding: 15px 30px;
    border-radius: 50px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
    font-weight: 600;
    z-index: 1000;
    animation: slideIn 0.5s ease-out;
    border: 1px solid rgba(90, 140, 240, 0.3);
    backdrop-filter: blur(10px);
    display: none;
    color: #fefefe
  }

  @keyframes slideIn {
    from {
      top: -50px;
      opacity: 0;
    }

    to {
      top: 20px;
      opacity: 1;
    }
  }

  .thirdsitfeature {
    color: wheat
  }

  .thirdsitfeatureicon {
    margin-right: 12px;
    font-size: 1.6vw;
  }

  /* 响应式调整 */
  @media (max-width: 1200px) {
    .thirdsitleftpanel {
      width: 12%;
    }

    .thirdsitrightpanel {
      width: 86%;
    }

    .thirdsitbtn {
      font-size: 1.3vw;
    }
  }

  @media (max-width: 768px) {
    .thirdsitcontainer {
      flex-direction: column;
    }

    .thirdsitleftpanel {
      width: 95%;
      height: 15%;
      flex-direction: row;
      margin: 1% auto;
      padding: 1%;
    }

    .thirdsitrightpanel {
      width: 95%;
      height: 82%;
      margin: 0 auto;
    }

    .thirdsitbtn {
      width: 18%;
      height: 90%;
      margin: 0 1%;
      font-size: 1.8vw;
    }

    .thirdsittimerdisplay {
      font-size: 12vw;
    }

    .thirdsitfeature {
      font-size: 3.5vw;
    }

    .thirdsitfeatureicon {
      font-size: 4vw;
    }
  }

  /*第三页放松*/
  #thirdrelaxGameContainer {
    position: relative;
    width: 90%;
    max-width: 500px;
    height: 80vh;
    background: linear-gradient(to bottom, #87CEEB 60%, #6B8E23 40%);
    border-radius: 20px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
    overflow: hidden;
  }

  /* 开始界面 */
  #thirdrelaxStartScreen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: rgba(30, 30, 80, 0.9);
    z-index: 10;
    transition: all 0.5s ease;
    background-repeat: no-repeat;
    background-image: url("./src/46.webp");
    background-size: 100% 100%;
  }

  #thirdrelaxGameTitle {
    color: #ff8921;
    font-size: 100px;
    text-align: center;
    font-weight: 780;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
    margin-bottom: 5%;
    animation: titlePulse 2s infinite;
  }

  #thirdrelaxStartButton {
    background: linear-gradient(to bottom, #4CAF50, #2E7D32);
    color: white;
    border: none;
    border-radius: 50px;
    padding: 15px 40px;
    font-size: 1.5rem;
    cursor: pointer;
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
    transition: all 0.3s;
  }

  #thirdrelaxStartButton:hover {
    transform: scale(1.1);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
    background: linear-gradient(to bottom, #66BB6A, #388E3C);
  }

  /* 游戏界面 */
  #thirdrelaxGameScreen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: none;
  }

  #thirdrelaxBird {
    position: absolute;
    width: 6%;
    height: 6%;
    background: #FFD700;
    border-radius: 50%;
    left: 20%;
    top: 50%;
    transform: translateY(-50%);
    z-index: 5;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    transition: top 0.1s;
  }

  .thirdrelaxPipe {
    position: absolute;
    width: 10%;
    background: linear-gradient(to right, #4CAF50, #2E7D32);
    border-left: 4px solid #1B5E20;
    border-right: 4px solid #1B5E20;
  }

  #thirdrelaxScoreDisplay {
    position: absolute;
    top: 10%;
    left: 50%;
    transform: translateX(-50%);
    color: white;
    font-size: 2.5rem;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    z-index: 4;
  }

  /* 结算界面 */
  #thirdrelaxEndScreen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: rgba(30, 30, 80, 0.9);
    z-index: 10;
  }

  #thirdrelaxFinalScore {
    color: #FFD700;
    font-size: 3rem;
    margin-bottom: 5%;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
  }

  #thirdrelaxRestartButton {
    background: linear-gradient(to bottom, #2196F3, #0D47A1);
    color: white;
    border: none;
    border-radius: 50px;
    padding: 15px 40px;
    font-size: 1.5rem;
    cursor: pointer;
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
    transition: all 0.3s;
  }

  #thirdrelaxRestartButton:hover {
    transform: scale(1.1);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
    background: linear-gradient(to bottom, #42A5F5, #1565C0);
  }

  /* 地面 */
  #thirdrelaxGround {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 15%;
    background: linear-gradient(to bottom, #8B4513, #5D4037);
    z-index: 3;
  }

  /* 云朵 */
  .thirdrelaxCloud {
    position: absolute;
    background: white;
    border-radius: 50%;
    opacity: 0.8;
  }

  /* 小鸟翅膀动画 */
  .wing {
    position: absolute;
    width: 40%;
    height: 20%;
    background: #FFC107;
    border-radius: 50%;
    top: 40%;
    right: -10%;
    animation: flap 0.3s infinite alternate;
  }


  /* 动画 */
  @keyframes titlePulse {

    0%,
    100% {
      transform: scale(1);
    }

    50% {
      transform: scale(1.05);
    }
  }

  @keyframes flap {
    from {
      transform: rotate(0deg);
    }

    to {
      transform: rotate(20deg);
    }
  }

  /* 响应式设计 */
  @media (max-width: 600px) {
    #thirdrelaxGameTitle {
      font-size: 2.5rem;
    }

    #thirdrelaxScoreDisplay {
      font-size: 2rem;
    }
  }
































































































  /*第四个*/

  #forthProgressContainer:hover #forthProgressBar {
    background-color: darkblue;
  }

  #rightforth {
    margin-top: 0;
    position: relative;
    width: 100%;
    height: 100%;
    border: 1px solid black;
  }

  #forthMoodModal {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: linear-gradient(-260deg, #11ff0027, #0318ff5f, #ff00007f);
    z-index: 9999;
    transition: opacity .4s;
  }

  /*第四个仔细css*/
  #iamjoy:hover {
    border: 1px solid black;
    background-color: #45ff51;
  }

  #iamsad:hover {
    border: 1px solid black;
    background-color: #45d7ff;
  }

  #iamanger:hover {
    border: 1px solid black;
    background-color: #ff6145;
  }

  #ilikeit:active,
  #idontlikeit:active {
    border: 2px solid white;
    box-shadow: inset 1px 2px 0px 1px black;
    background-color: #b0ffcb;
  }

  #ilikeit,
  #idontlikeit {
    width: 100%;
    height: 45%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 25px;
    font-weight: 560;
    background-color: #fffc4573;
    background-repeat: no-repeat;
    background-size: auto 100%;
    background-position: 10px 50%;
    border: 1px solid black;
    transition: border 0s ease, box-shadow 0s ease, background-color 0s ease;
  }

  #ilikeit:hover,
  #idontlikeit:hover {
    cursor: pointer;
  }

  #ilikeit:hover {
    background-color: #ff60cdab !important;
  }

  #idontlikeit:hover {
    background-color: #87878780 !important;
  }

  #ilikeit {
    background-image: url("./src/24.png");
  }

  #idontlikeit {
    background-size: auto 80%;
    background-position: 15px 50%;
    background-image: url("./src/34.png");
  }







  #forthmain {
    width: 100%;
    height: 100%;
    border: 1px solid black;
  }

  .moodBtn {
    font-size: 2vw;
    margin: 0 2vw;
    padding: 1vw 3vw;
    border: 1px solid #ccc;
    border-radius: 12px;
    background: #fff;
    cursor: pointer;
    transition: .2s
  }

  .moodBtn:hover {
    background: #f2f2f2
  }

  #forthMusicCover {
    border: 3px solid black;
    background-repeat: no-repeat;
    background-size: 100% 100%;
    background-image: url("./src/36.jpg");
  }

  #forthPlayerBox {
    border: 3px solid rgb(0, 0, 0);
  }

  #forthPrevBtn,
  #forthPlayPauseBtn,
  #forthNextBtn {
    width: 12%;
    height: 100%;
    /* border: 1px solid red; */
    border-radius: 0px;
  }

  #forthPrevBtn:hover,
  #forthPlayPauseBtn:hover,
  #forthNextBtn:hover {
    background-color: #99ff9e;
    box-shadow: 2px 3px 2px 1px #84878488;
    border-radius: 35px;
    cursor: pointer;
  }

  #forthPlayPauseBtn {
    background-image: url("./src/18.png");
  }

  #forthPrevBtn {
    background-image: url("./src/19.png");
  }

  #forthNextBtn {
    background-image: url("./src/20.png");
  }

  #forthMainMusic {
    height: 50%;
    border: 1px solid rgb(0, 0, 0);
  }




  #forthmusicul {
    border: 1px solid black;
    width: 85%;
    height: 45%;
    scrollbar-width: auto;
    scrollbar-color: #ce95ffe7;
    list-style: none;
    overflow-y: auto;
    margin: 2px auto;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .forthmainmusicli {
    width: 70%;
    min-height: 35%;
    border: 1px solid rgb(255, 255, 255);
    font-size: 25px;
    display: flex;
    align-items: center;
    justify-content: space-evenly;


  }

  .musicgo {
    width: 60%;
    height: 80%;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
  }

  .musicgoimg,
  .musicgoimggoing {
    width: 25%;
    height: 80%;
    box-shadow: 0 0 0 0px #000;
  }

  .musicgoimg:hover,
  .musicgoimggoing:hover {
    width: 26%;
    height: 81%;
    border: 2px solid black;
    box-shadow: 0 0 0 3px #fff;
    cursor: pointer;
  }

  #yourlikeul {
    scrollbar-width: auto;
    scrollbar-color: #ce95ffe7;
    list-style: none;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    width: 55%;
    height: 30%;
    border: 1px solid rgb(0, 0, 0);
    margin: 0 auto;
    align-items: center;
  }

  .yourlikeli {
    width: 80%;
    min-height: 45%;
    border: 1px solid rgb(0, 0, 0);
    font-size: 35px;
    font-weight: 580;
    background-color: #aefcdf;
    transition: border ease 0s;
  }

  .yourlikeli:hover {
    border: 3px solid black;
    box-shadow: 2px 3px 2px 1px #fff;
    background-color: #f7ffc79f;
    cursor: pointer;
  }

  #forthend {
    display: none;
    margin-top: 20%;
    border: 1px solid red;
    align-items: center;
    justify-content: center;
  }

  #forthreturn {
    position: absolute;
    right: 20px;
    top: 50%;
  }



  #forthmusictile {
    width: 80%;
    height: 10%;
    margin: 5px auto;
    font-size: 25px;
    font-weight: 580;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #forthmusicoptiondiv {
    width: 90%;
    height: 70%;
    margin: 10px auto;
    border: 5px solid rgba(255, 101, 101, 0.648);
  }

  .forthOptionBox {
    width: 30%;
    height: 40%;
    background-color: #ccc;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 10px;
    background-repeat: no-repeat;
    background-size: 100% 100%;
    color: #d8ffeb;
    transition: border 0s ease, box-shadow 0s ease;
  }

  .forthOptionBox:hover {
    background-color: #aaa;
    border: 2px solid white;
    cursor: pointer;
    box-shadow: 1px 1px 1px 1px #000;
  }

  #option1 {
    background-image: url("./src/26.jpg");
  }

  #option2 {
    background-image: url("./src/27.jpg");
  }

  #option3 {
    background-image: url("./src/28.jpg");
    color: #4b4b4b
  }

  #option4 {
    background-image: url("./src/29.jpg");
  }

  #option5 {
    background-image: url("./src/30.jpg");
  }

  #option6 {
    background-image: url("./src/31.jpg");
  }

  .forthbutton {
    width: 150px;
    height: 50px;
    border: 2px solid black;
    background-color: #97fff5;
    font-size: 20px;
    font-weight: 660;
    font-family: "KaiTi";
  }

  .forthbutton:hover {
    width: 155px;
    height: 55px;
    border: 3px solid black;
    background-color: #dfadff;
    box-shadow: 3px 5px 3px 3px #ccc;
    border-radius: 10px;
  }

  .forthbutton:active {
    background-color: #ff2eaf;
    box-shadow: inset 0 0 0 8px rgba(0, 0, 0, 0.256);
  }

  /*第四页问卷*/
  .evaluation-wrapper {
    width: 100%;
    padding: 2%;
    box-sizing: border-box;
    height: auto;
    display: flex;
    flex-wrap: wrap;
    background: #fafafa;
    border-top: 2px solid #ccc;
    border-radius: 16px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    gap: 2%;
  }

  /* 问卷区域 */
  .evaluation-questions {
    width: 58%;
    padding: 2%;
    background-color: #fff;
    border-radius: 12px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
  }

  .question-block {
    margin-bottom: 24px;
  }

  .radio-group {
    display: flex;
    justify-content: space-between;
    margin-top: 10px;
    flex-wrap: wrap;
  }

  .radio-group label {
    font-size: 1rem;
    padding: 6px 12px;
    border-radius: 6px;
    transition: background-color 0.2s ease;
    cursor: pointer;
  }

  .radio-group input[type="radio"] {
    margin-right: 6px;
  }


  .evaluation-controls {
    width: 38%;
    padding: 2%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-around;
    background-color: #f8f8f8;
    border-radius: 12px;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
  }


  .styled-button {
    padding: 12px 24px;
    font-size: 1rem;
    font-weight: bold;
    background: linear-gradient(to right, #66bb6a, #43a047);
    color: white;
    border: none;
    border-radius: 8px;
    margin: 8px 0;
    cursor: pointer;
    transition: background-color ease 0.3s;
  }

  .styled-button:hover {
    background: linear-gradient(to right, #81c784, #66bb6a);
  }

  .progress-bar {
    width: 80%;
    height: 12px;
    background-color: #ddd;
    border-radius: 6px;
    margin-top: 12px;
    overflow: hidden;
  }

  .progress-bar-fill {
    width: 0%;
    height: 100%;
    background-color: #4caf50;
    transition: width 0.5s ease-in-out;
  }

  .submit-status-text {
    margin-top: 10px;
    color: #666;
    font-size: 0.9rem;
  }

  /*第四页动画*/
  /* 遮罩淡入 */
  @keyframes fadeInMask {
    from {
      opacity: 0;
    }

    to {
      opacity: 1;
    }
  }

  /* 文字飘落 */
  @keyframes dropDown {
    0% {
      transform: translateY(-60px) scale(0.9);
      opacity: 0;
    }

    100% {
      transform: translateY(0) scale(1);
      opacity: 1;
    }
  }

  /* 按钮蹦出（带弹性） */
  @keyframes bounceUp {
    0% {
      transform: translateY(40px) scale(0.5);
      opacity: 0;
    }

    60% {
      transform: translateY(-5px) scale(1.1);
    }

    100% {
      transform: translateY(0) scale(1);
      opacity: 1;
    }
  }

  /* 触发器：加 .animate-mood 后开始动画 */
  .animate-mood#forthMoodModal {
    animation: fadeInMask .35s ease-out forwards;
    display: flex;
    /* 保证 flex 居中 */
    align-items: center;
    justify-content: center;
  }

  .animate-mood #forthMoodModal p:nth-of-type(1) {
    animation: dropDown .45s ease-out .15s forwards;
    opacity: 0;
  }

  .animate-mood #forthMoodModal p:nth-of-type(2) {
    animation: dropDown .45s ease-out .25s forwards;
    opacity: 0;
  }

  .animate-mood .moodBtn:nth-of-type(1) {
    animation: bounceUp .4s ease-out .35s forwards;
    opacity: 0;
  }

  .animate-mood .moodBtn:nth-of-type(2) {
    animation: bounceUp .4s ease-out .45s forwards;
    opacity: 0;
  }

  .animate-mood .moodBtn:nth-of-type(3) {
    animation: bounceUp .4s ease-out .55s forwards;
    opacity: 0;
  }


  @keyframes slideUpFade {
    from {
      transform: translateY(40px);
      opacity: 0;
    }

    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  /* 子元素依次弹出 */
  @keyframes popIn {
    0% {
      transform: scale(0.6) translateY(30px);
      opacity: 0;
    }

    100% {
      transform: scale(1) translateY(0);
      opacity: 1;
    }
  }

  /* 触发器：加了这个类就开始动画 */
  .animate-forth .forthPlayerBar,
  .animate-forth #forthMainMusic {
    animation: slideUpFade .45s ease-out forwards;
  }

  .animate-forth #forthMusicCover {
    animation: popIn .35s ease-out .15s forwards;
    opacity: 0;
    /* 先隐藏，等动画 */
  }

  .animate-forth #forthPlayerBox {
    animation: popIn .35s ease-out .25s forwards;
    opacity: 0;
  }

  .animate-forth #forthEvalBox {
    animation: popIn .35s ease-out .35s forwards;
    opacity: 0;
  }

  /* 主内容区里的子元素也统一 popIn，但延迟继续加大 */
  .animate-forth #forthMusicList,
  .animate-forth #forthMusicOptions {
    animation: popIn .4s ease-out .45s forwards;
    opacity: 0;
  }



  /*第五页*/
  #rightfifthhead {
    width: 100%;
    height: 18%;
    display: flex;
    justify-content: space-evenly;
    align-items: center;

  }

  #user2 {
    width: 40%;
    height: 80%;
    background-color: #cbcbcb;
    border: 1px solid rgba(0, 0, 0, 0.107);
    display: flex;
    justify-content: space-evenly;
    flex-direction: column;
    align-items: center;
    border-radius: 15px;
  }

  #user2:hover {
    background-color: #ffffff;
  }

  #userup2 {
    width: 90%;
    height: 40%;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
  }

  #userupfirst2 {
    width: 50%;
    height: 100%;
    background-image: url("./src/12.png");
    background-repeat: no-repeat;
    background-size: auto 100%;
    background-position: left;
    /* border: 1px solid red; */
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 20px;
    font-weight: 520;
    color: #007bff;

  }

  #userupsecond2 {
    width: 20%;
    height: 100%;
    background-image: url("./src/13.png");
    background-repeat: no-repeat;
    background-size: auto 100%;
  }

  #userdown1 {
    width: 100%;
    height: 40%;
  }



  /*  aaaeee */

  #rightfifthtitle {
    width: 40%;
    height: 90%;
    margin-top: 15px;
    margin-left: 12px;
    align-items: center;
    border: 1px solid black;
    background-color: rgba(231, 231, 231, 0.452);
    box-shadow: 1px 1px 00 #000;
  }

  #rightfifthtitle:hover {
    background-color: #ffb5b5;
  }

  #fifthbigtitle {
    margin: 5px auto;
    width: 50%;
    height: 50%;
  }

  #fifthlittletitle {
    margin: 2px auto;
    width: 50%;
    height: 40%;
  }

  #fifthbigtitle,
  #fifthlittletitle {
    display: flex;
    justify-content: center;
    align-items: center;

  }

  #fifthbigtitle {
    font-size: 60px;
    font-weight: 660;
    font-family: "KaiTi";
  }

  #fifthlittletitle {
    font-size: 20px;
    font-weight: 560;
  }

  #rightfifthbook {
    width: 100%;
    height: 40%;
    margin-top: 10px;
    display: flex;
    border: 2px solid rgba(0, 0, 0, 0.132);
    box-shadow: 1px 2px 0 0 #ccc;
    justify-content: space-evenly;
    align-items: center;
    background-color: #34e7ff69;
  }

  #rightfifthbook:hover {
    background-color: #9ff1ff;
  }

  #rightfifthdaily {
    width: 30%;
    height: 85%;
  }





  /**/
  #fifthContainer {
    width: 100%;
    height: 100%;
    display: flex;
    background-color: #e6ffa161;
    flex-direction: column;
    border-radius: 15px;
    border: 5px solid black;
    box-sizing: 1px 2px 0 0 #000;
  }

  /* 顶部：每日一句 */
  #fifthTopQuote {
    width: 100%;
    height: 15%;
    background-color: #a5f4fe6d;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    color: #00796b;
  }

  #fifthTopQuote:hover {
    background-color: #a0e4ff;
  }

  /* 中间主体 */
  #fifthMainContent {
    width: 100%;
    height: 50%;
    display: flex;
    flex-direction: row;
    background-color: #7a7a7a65;
  }

  #fifthMainContent:hover {
    background-color: #00000000;
  }

  /* 左侧：当前日期与情绪提示 */
  #fifthLeftPanel {
    width: 60%;
    height: 100%;
    background-color: #f1f8e9;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 2%;
  }

  #fifthDateInfo {
    font-size: 15px;
    color: #33691e;
    margin-bottom: 2%;
  }

  #fifthDateNumber {
    font-size: 60px;
    font-weight: bold;
    color: #558b2f;
  }

  #fifthEmotionTip {
    margin-top: 2%;
    font-size: 12px;
    color: #4e342e;
    text-align: center;
  }

  /* 右侧：HTML5 日历控件 */
  #fifthRightPanel {
    width: 30%;
    height: 100%;
    background-color: #ffffff;
    padding: 5%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  #fifthDatePickerLabel {
    font-size: 15px;
    font-weight: 560;
    margin-bottom: 5%;
    color: #333;
  }

  #fifthDatePicker {
    width: 90%;
    height: 20%;
    font-size: 1vw;
    padding: 2%;
  }

  /* 底部按钮区域 */
  #fifthFooter {
    width: 100%;
    height: 35%;
    background-color: #96969664;
    display: flex;
    justify-content: space-around;
    align-items: center;
  }

  #fifthFooter:hover {
    background-color: #e3e3e3;
  }

  .fifthActionButton {
    width: 25%;
    height: 50%;
    background-color: #e3f2fd;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid #90caf9;
    cursor: pointer;
    padding: 2%;
    font-size: 20px;
  }

  .fifthActionButton:hover {
    background-color: #aafff1c0;
    border: 1px solid #48adff;
    box-shadow: 1px 0 0 1px rgb(55, 55, 255);
  }


  .fifthActionButton img {
    width: 20%;
    height: auto;
    margin-right: 5%;
  }

  .fifthActionButton span {
    font-size: 1vw;
    color: #1565c0;
  }

  #rightfifthmain {
    width: 65%;
    height: 80%;

  }

  #rightfifthmainfirst {
    width: 100%;
    height: 65%;
    display: flex;
    justify-content: space-evenly;
    align-items: center;
    background-color: #ff8cdc3b;
  }

  .rightfifthmainitem {
    width: 20%;
    height: 70%;
    border: 2px solid rgb(41, 41, 41);
    border-radius: 8px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 20px;
    font-weight: 560;
    transition: border 0s ease;
  }

  .rightfifthmainitem:hover {
    background-color: #adc4ff !important;
    border: 2px solid white;
    box-shadow: 1px 1px 0 1px #6d76f3;
  }

  .rightfifthmainitem:active {
    width: 18%;
    height: 60%;
    box-shadow: inset 1px 1px 0 1px #6d76f3;
  }

  #rightfifthmainsecond {
    width: 100%;
    height: 60%;

    display: flex;
    justify-content: space-evenly;
    align-items: center;
    margin-top: 5px;
  }

  .fifthmainsecondimg {
    width: 20%;
    height: 100%;
    background-repeat: no-repeat;
    background-size: 100% 100%;
    opacity: 0;
    background-image: url("./src/41.png");
  }

  .fifthmainsecondimg:hover {
    background-image: url("./src/40.png");
  }

  #rightfifthable {
    width: 90%;
    height: 38%;
    margin: 0 auto;
    margin-top: 40px;
    position: relative;
    overflow: hidden;
    background-color: #99ff9b4c;
    border: 2px solid black;
    box-shadow: 3px 4px 0 0 #000;

  }

  #rightfifthable:hover {
    background-color: #9fffcd;
  }

  /**/
  .fifthSection {
    background-color: #98ffbc84;

    position: absolute;
    top: 0;
    left: 0;
    transition: opacity 0.3s ease-in-out;
  }

  .fifthSectionchart {
    width: 100%;
    height: 50%;
    border: 5px solid green;
    position: relative;
  }

  .fifthButton {
    background-color: #6c63ff;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 5px;
    font-size: 13px;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out;
  }

  .fifthButtonreturn {
    background-color: #6c63ff;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 5px;
    font-size: 13px;
    cursor: pointer;
    position: absolute;
    right: 10px;
    top: 6px;
    transition: background-color 0.2s ease-in-out;
  }

  .fifthButton:hover,
  .fifthButtonreturn:hover {
    background-color: #574fd6;
  }

  .fifthButton:active,
  .fifthButtonreturn:active {
    transform: scale(0.95);
  }

  @keyframes fifthButtonFadeInUp {
    0% {
      opacity: 0;
      transform: translateY(30px);
    }

    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .fifthButtonAnimation,
  .fifthButtonreturnAnimation {
    animation: fifthButtonFadeInUp 0.6s ease-out;
  }


  .fifthcanvas {
    width: 100%;
    height: 70%;
  }

  .fifthRecordItem {
    display: flex;
    justify-content: space-between;
    background: #fff;
    border-radius: 6px;
    padding: 8px 10px;
    border: 1px solid #eee;
    box-shadow: 0 0 3px rgba(0, 0, 0, 0.05);
    font-size: 13px;
  }

  .fifthRecordActions button {
    margin-left: 5px;
    background: transparent;
    border: none;
    color: #6c63ff;
    cursor: pointer;
  }

  .fifthRecordActions button:hover {
    text-decoration: underline;
  }

  .fifthModuleBox {
    background: #fff;
    border-radius: 8px;
    padding: 10px;
    margin-top: 10px;
    box-shadow: 0 0 5px rgba(0, 0, 0, 0.05);
    font-size: 14px;

  }

  .fifthModuleBox:hover {
    cursor: pointer;
    background-color: #89898994;
    border: #007bff 1px solid;
    box-shadow: 1px 2px 0px 0px #1d4fd866;
  }

  .fifthChartLink {
    cursor: pointer;
    transition: background 0.2s ease-in-out;
  }

  .fifthChartLink:hover {
    background: #eef1ff;
  }

  rect {
    cursor: pointer;
    rx: 2;
    fill: #E5E7EB
  }

  .l0 {
    fill: #BFDBFE
  }

  .l1 {
    fill: #60A5FA
  }

  .l2 {
    fill: #3B82F6
  }

  .l3 {
    fill: #1D4ED8
  }

  /*日历热力图*/
  :root {
    --cell-size: min(2.2vw, 14px);
    --gap: calc(var(--cell-size) * 0.15);
  }



  #wrapper {
    position: relative;
    max-width: 700px;
    margin: auto;
    overflow: auto;
    width: 100%;
    height: 100%;
    background-color: #aef7ff6f;
    /* 关键：出现滚动条 */
  }

  /* 2. 高亮动画 */
  @keyframes pulse {
    0% {
      stroke: #fbbf24;
      stroke-width: 2;
    }

    50% {
      stroke: #f59e0b;
      stroke-width: 3;
    }

    100% {
      stroke: none;
      stroke-width: 0;
    }
  }

  .jump-flash {
    animation: pulse 1s ease-in-out;
  }

  #cal {
    width: 100%;
    height: 80%;
    /* 父级可随意缩放 */
    display: block;
    background-color: #010101;
  }

  rect {
    rx: 2;
    cursor: pointer
  }

  .l0 {
    fill: #bfdbfe
  }

  .l1 {
    fill: #60a5fa
  }

  .l2 {
    fill: #3b82f6
  }

  .l3 {
    fill: #1d4ed8
  }

  .l4 {
    fill: #1e3a8a
  }

  .none {
    fill: #e5e7eb
  }

  /* 星期标签 */
  text.wday {
    font-size: calc(var(--cell-size) * 0.8);
    fill: #6b7280
  }

  /* 右上角索引 */
  #index {
    position: absolute;
    top: 0;
    right: 0;
    display: flex;
    gap: 6px;
    align-items: center;
    background: #fff;
    border: 1px solid #c7d2fe;
    border-radius: 4px;
    padding: 4px 6px;
    font-size: 12px;
  }

  #index input {
    width: 95px;
    padding: 2px 4px;
    border: 1px solid #c7d2fe;
    border-radius: 3px
  }

  #index button {
    padding: 2px 6px;
    border: none;
    border-radius: 3px;
    background: #3b82f6;
    color: #fff;
    cursor: pointer
  }

  /* 弹窗 */
  #dlg {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, .45);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 999
  }

  #dlg.hidden {
    display: none
  }

  #box {
    background: #fff;
    border-radius: 8px;
    padding: 20px;
    width: 260px
  }

  #box h3 {
    margin: 0 0 10px;
    font-size: 15px
  }

  #box label {
    font-size: 13px
  }

  #box select,
  #box textarea {
    width: 100%;
    margin: 4px 0 8px;
    padding: 4px;
    border: 1px solid #c7d2fe;
    border-radius: 3px
  }

  #box button {
    margin-right: 6px;
    padding: 4px 10px;
    border: none;
    border-radius: 3px;
    cursor: pointer
  }

  #save {
    background: #3b82f6;
    color: #fff
  }

  #del {
    background: #ef4444;
    color: #fff
  }

  #cancel {
    background: #e5e7eb
  }


  @keyframes fifthFadeInUp {
    0% {
      opacity: 0;
      transform: translateY(30px);
    }

    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }


  .fifth-animate-in {
    animation: fifthFadeInUp 0.6s ease-out;
  }
</style>

<body>
  <div id="all" style="background:linear-gradient(135deg, #7b95ff, #ff8787, #4dff74);">


    <div id="left">

      <div id="leftupimg">
      </div>
      <div id="leftupsay">
        情绪管理系统
      </div>
      <!--leftup-->

      <div id="leftmain">

        <ui id="leftmainui">
          <li style="--i:0" class="leftmainli" onclick="leftmainlichange(0)">
            <div class="leftmainlipic" id="leftmainlipic1"></div>
            <p class="leftmainlisay">总绪</p>
          </li>
          <li style="--i:1" class="leftmainli" onclick="leftmainlichange(1)">
            <div class="leftmainlipic" id="leftmainlipic2"></div>
            <p class="leftmainlisay">情绪识别</p>
          </li>
          <li style="--i:2" class="leftmainli" onclick="leftmainlichange(2)">
            <div class="leftmainlipic" id="leftmainlipic3"></div>
            <p class="leftmainlisay">情绪调频</p>
          </li>
          <li style="--i:3" class="leftmainli" onclick="leftmainlichange(3)">
            <div class="leftmainlipic" id="leftmainlipic4"></div>
            <p class="leftmainlisay">音乐疗愈</p>
          </li>
          <li style="--i:4" class="leftmainli" onclick="leftmainlichange(4)">
            <div class="leftmainlipic" id="leftmainlipic5"></div>
            <p class="leftmainlisay">情绪日志</p>
          </li>
        </ui>

      </div>
      <!-- leftmain -->

    </div>
    <!-- left -->


    <div id="right">

      <div id="rightfirst" class="right">

        <div id="rightfirsthead">

          <div id="recently">近期活动

            <select id="selectday">
              <option value="" selected>24小时</option>
              <option value="">三天</option>
              <option value="">一周</option>
              <option value="">一个月</option>
              <option value="">半年</option>
            </select>
          </div>
          <div id="recentlyact">
            <div class="recentlyactivity">
              <img src="./src/10.png" alt="" class="actimg">
              完成<p id="activitysay">音乐疗愈</p>。您最常聆听的音乐是<p id="activitysay">《重返御神体》</p>,昨日已进行<p id="activitysay">12</p>次聆听
            </div>
            <div class="recentlyactivity">
              <img src="./src/10.png" alt="" class="actimg">
              完成<p id="activitysay">情绪识别</p>，又向数据库提交了您的情绪数据。上次所识别的是<p id="activitysay">文本</p>数据，显示您的情绪是<p
                id="activitysay1">焦虑</p>。
            </div>
            <div class="recentlyactivity">
              <img src="./src/11.png" alt="" class="actimg">
              正在进行<p id="activitysay">情绪日志</p>，您尚未完成今日情绪记录。
            </div>
          </div>
          <div id="user">
            <div id="userup">
              <div id="userupfirst">root用户</div>
              <div id="userupsecond" onclick="changebell()"></div>
            </div>

            <div id="userdown">
              <div class="search-box">
                <input type="text" placeholder="搜索功能…" class="search-input">
                <i class="fas fa-search search-icon"></i>
              </div>
            </div>
          </div>

        </div>

        <div id="rightfirstmain">
          <div id="rightfirstmainleft">
            <canvas id="rightfirstmainleftchart"></canvas>
          </div>

          <div id="rightfirstmainright">
            <ui id="rightfirstmainrightui">
              <li class="rightfirstmainrightli">
                <p class="firstmainsay">本周情绪激动的次数为</p>
                <p class="firstmainsayfocus">5</p>
                <p class="firstmainsaymath" id="saymath1">较上周减少23%</p>
              </li>
              <li class="rightfirstmainrightli">
                <p class="firstmainsay">本周进行音乐疗愈的次数为</p>
                <p class="firstmainsayfocus">43</p>
                <p class="firstmainsaymath" id="saymath2">较上周增加6%</p>
              </li>
              <li class="rightfirstmainrightli">
                <p class="firstmainsay">本周进行的情绪记录篇数为</p>
                <p class="firstmainsayfocus">7</p>
                <p class="firstmainsaymath" id="saymath3">较上周增加0%</p>
              </li>
            </ui>
          </div>

        </div>

        <div id="rightfirstchart">
          <div id="rightfirstchartfirst">
            <h2>本周情绪趋势</h2>
            <div id="chartWrapper"><canvas id="chart"></canvas></div>
            <div class="legend">
              <div class="legend-item"><span class="legend-color" style="background:#ff6b6b"></span>愉悦</div>
              <div class="legend-item"><span class="legend-color" style="background:#4ecdc4"></span>平静</div>
              <div class="legend-item"><span class="legend-color" style="background:#ffa726"></span>焦虑</div>
            </div>
          </div>

          <div id="rightfirstchartsecond">
            <canvas id="emotionPie"></canvas>
          </div>

        </div>

      </div>
      <!-- first -->
      <div id="rightsecond" class="right">

        <div id="rightsecondhead">
          <div id="secondheadleft">
            <div id="secondheadleftfirst">
              <h1>情绪识别</h1>
              <p>上传文本、图片、音频数据以予大模型分析</p>
            </div>
            <canvas id="emotionhistory"></canvas>
          </div>


          <div id="user1">
            <div id="userup">
              <div id="userupfirst">root用户</div>
              <div id="userupsecond" onclick="changebell()"></div>
            </div>

            <div id="userdown">
              <div class="search-box">
                <input type="text" placeholder="搜索记录…" class="search-input">
                <i class="fas fa-search search-icon"></i>
              </div>
            </div>
          </div>
        </div>

        <div id="rightsecondmain">
          <div id="rightsecondmainhead">
            <div class="secondmainheadli" onclick="changesecondmain(0)" id="secondmainheadlifirst">文本识别</div>
            <div class="secondmainheadli" onclick="changesecondmain(1)">图片识别</div>
            <div class="secondmainheadli" onclick="changesecondmain(2)">音频识别</div>
            <div class="secondmainheadli" onclick="changesecondmain(3)">脑电识别</div>
          </div>

          <div id="secondmainmain">

            <div id="secondmainleft">

              <div class="secondmainleftsay">
                <p class="secondmainleftsaysay" id="secondmainleftsay1">透过对字里行间的行文的分析串联起一个个无声的文字</p>
                <p class="secondmainleftsaysay" id="secondmainleftsay2">织成细腻而婉转的笔者的弦外之音</p>
                <p class="secondmainleftsaysay" id="secondmainleftsay3">从而剖析出，每一句所蕴含的情绪的意义</p>
              </div>

              <div id="test">
                <div id="testup">
                  <input type="file" id="testin">
                </div>
              </div>

              <div id="secondmainbottom">
                <p id="secondmainbottomsay">请确认上传的是文本数据！</p>
                <input type="button" value="提交" id="secondmainbutton" onclick="buttoncheck()">
              </div>

            </div>

            <div id="secondmainright">

              <div id="secondmainrighttitle">
                结果分析
              </div>

              <div class="secondmainprogress"></div>
              <div class="secondmainprogress"></div>
              <div class="secondmainprogress"></div>


            </div>

          </div>

        </div>

      </div>

      <!-- second -->

      <div id="rightthird" class="right" style="width: 100%; height: 100%; position: relative; overflow: hidden;">

        <!-- 总目录页 -->
        <div id="thirdmainmenu"
          style="display: flex; flex-wrap: wrap; width: 100%; height: 100%; position: absolute; top: 0; left: 0;">

          <!-- 四个功能区域 -->
          <div id="thirdinteractive" class="thirdbox"
            style="background: linear-gradient(90deg, #3770ff, #d3ff5a, #4b2b5a)">
            <!-- 小型简化聊天框架 -->
            <div id="thirdinteractivepreview"
              style="width: 90%; height: 90%; display: flex; flex-direction: column; border: 1px solid #ccc; background-color: #fdfdfd; padding: 2%; box-sizing: border-box;">

              <!-- 主题栏 -->
              <div style="width: 100%; font-weight: bold; text-align: center; margin-bottom: 5%;">AI排忧解愁</div>

              <!-- 聊天区域（缩略不滚动） -->
              <div style="flex: 1; overflow: hidden; font-size: 0.8vw; display: flex; flex-direction: column; gap: 2%;">
                <div style="align-self: flex-start; display: flex; align-items: center;">
                  <img src="./src/42.png" alt="你的朋友"
                    style="width: 1.5vw; height: 1.5vw; background-color: #aaa; border-radius: 50%; margin-right: 0.5vw;">

                  <div style="background-color: #e0e0e0; border-radius: 10px; padding: 0.3vw 0.6vw;">你好，我是AI</div>
                </div>
                <div style="align-self: flex-end; display: flex; align-items: center;">
                  <div
                    style="background-color: #6c63ff; color: white; border-radius: 10px; padding: 0.3vw 0.6vw; margin-right: 0.5vw;">
                    你好！</div>
                  <img src="./src/12.png" alt="你"
                    style="width: 1.5vw; height: 1.5vw; background-color: #ffffff; border-radius: 50%;">
                </div>

              </div>

              <!-- 输入框区域 -->
              <div id="thirdfirsttext" style="margin-top: 5%; display: flex; justify-content: space-between; gap: 2%;">
                <input type="text" placeholder="请输入..." style="flex: 1; padding: 2%; font-size: 0.8vw;width: 80%;">
                <button id="smallsent"
                  style="padding: 2% 5%; background-color: #ffb7b7; color: rgb(84, 84, 84); font-size: 0.8vw;">发送</button>
              </div>
            </div>
          </div>


          <div id="thirdrelax" class="thirdbox" style="background :linear-gradient(135deg, #1a6c25, #2e1fb2, #c023e3);">

            <!-- 开始界面 -->
            <div id="thirdrelaxStartScreen">
              <h1 id="thirdrelaxGameTitle">Flappy Bird</h1>
              <button id="thirdrelaxStartButton" onclick="longdaygo()">开始游戏</button>
            </div>

            <!-- 游戏界面 -->
            <div id="thirdrelaxGameScreen">
              <div id="thirdrelaxBird">
                <div class="wing"></div>
              </div>
              <div id="thirdrelaxScoreDisplay">0</div>
              <div id="thirdrelaxGround"></div>
            </div>

            <!-- 结算界面 -->
            <div id="thirdrelaxEndScreen">
              <h2 id="thirdrelaxFinalScore">得分: 0</h2>
              <button id="thirdrelaxRestartButton">重新开始</button>
            </div>

          </div>


          <div id="thirdmeditation" class="thirdbox"
            style="background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c)">
            <!-- 通知弹窗 -->
            <div class="thirdsitnotification" id="thirdsitnotification"></div>

            <div class="thirdsitcontainer">
              <!-- 左侧工具箱 -->
              <div class="thirdsitleftpanel">
                <button class="thirdsitbtn" id="thirdsitwhitenoise" title="白噪音">
                  <span class="thirdsitfeatureicon">🎵</span>
                </button>
                <button class="thirdsitbtn" id="thirdsitwaterreminder" title="喝水提醒">
                  <span class="thirdsitfeatureicon">💧</span>
                </button>
                <button class="thirdsitbtn" id="thirdsitmeditationmaterial" title="冥想材料">
                  <span class="thirdsitfeatureicon">📚</span>
                </button>
                <button class="thirdsitbtn thirdsitbtnaddremove" id="thirdsitaddfive" title="增加五分钟">
                  <span class="thirdsitfeatureicon">⏫</span>
                </button>
                <button class="thirdsitbtn thirdsitbtnaddremove" id="thirdsitsubfive" title="减少五分钟">
                  <span class="thirdsitfeatureicon">⏬</span>
                </button>
              </div>

              <!-- 右侧主区域 -->
              <div class="thirdsitrightpanel">
                <!-- 上部分：功能模块区域 -->
                <div class="thirdsitmainarea" id="thirdsitmainarea">
                  <!-- 初始提示 -->
                  <div class="thirdsitfeature" style="background: rgba(80, 120, 220, 0.3);">
                    <span class="thirdsitfeatureicon">🕊️</span>欢迎使用静坐冥想助手
                  </div>
                  <div class="thirdsitfeature" style="background: rgba(90, 180, 100, 0.3);">
                    <span class="thirdsitfeatureicon">💡</span>请从左侧选择需要的功能
                  </div>
                </div>

                <!-- 下部分：倒计时和进度条 -->
                <div class="thirdsittimerarea">
                  <div class="thirdsittimerdisplay" id="thirdsittimerdisplay">05:00</div>
                  <div class="thirdsitprogresscontainer">
                    <div class="thirdsitprogressbar" id="thirdsitprogressbar"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>




          <div id="thirdsleep" class="thirdbox">
            <!-- 小窗口模式 -->
            <div class="third-container third-small-mode">
              <h1 class="third-title">睡眠功能选择</h1>
              <div class="third-bubbles-container">
                <div class="third-bubble" id="third-focus-sleep">
                  <span>专注睡眠</span>
                </div>
                <div class="third-bubble" id="third-nap">
                  <span>略微小憩</span>
                </div>
                <div class="third-bubble" id="third-amsr">
                  <span>AMSR</span>
                </div>
                <div class="third-bubble" id="third-summary">
                  <span>睡眠总结</span>
                </div>
              </div>
            </div>
          </div>

          <!-- 中心菱形遥控按钮 -->
          <div id="thirddiamond" style="
      position: absolute;
      width: 20%;
      height: 20%;
      top: 40%;
      left: 40%;
      
      background: #f0f0f0;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
      display: flex;
      flex-wrap: wrap;
      z-index: 10;
    ">
            <div onclick="thirdShowPage('thirdinteractivepage')" class="thirddiamondbtn">交互</div>
            <div onclick="longdaygo()" class="thirddiamondbtn">放松</div>
            <div onclick="thirdsitStartMeditation()" class="thirddiamondbtn" id="thirdgamebtn">静坐</div>
            <div onclick="thirdShowPage('thirdsleeppage')" class="thirddiamondbtn">睡眠</div>
          </div>

        </div>

        <!-- 四个功能全屏页面 -->
        <div id="thirdinteractivepage" class="thirdpage">
          <button class="thirdbackbtn" onclick="thirdShowPage('thirdmainmenu')">返回</button>
          <div id="thirdchatcontainer"
            style="width: 90%; height: 90%; display: flex; flex-direction: column; box-sizing: border-box;">

            <!-- 主题栏 -->
            <div style="text-align: center; font-size: 2vw; font-weight: bold; margin-bottom: 2%;">AI排忧解愁</div>

            <!-- 聊天主区域 -->
            <div id="thirdchatbody" style="
    flex: 1;
    background-color: #f5f5f5;
    padding: 1.5%;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 1.5%;
    border-radius: 1vw;
  ">
              <!-- 示例对话 -->
              <div style="align-self: flex-start; display: flex; align-items: center;">
                <img src="./src/42.png"
                  style="width: 3vw; height: 3vw; background-color: #aaa; border-radius: 50%; margin-right: 0.8vw;">

                <div style="background-color: #e0e0e0; border-radius: 10px; padding: 0.5vw 1vw;">你好，我是AI</div>
              </div>
            </div>

            <!-- 输入区 -->
            <div style="display: flex; align-items: center; margin-top: 2%; gap: 1%;">
              <input id="thirdchatinput" type="text" placeholder="说点什么..."
                style="flex: 1; padding: 1.2%; font-size: 1vw; border-radius: 0.5vw; border: 1px solid #ccc;" />
              <button onclick="thirdSendMessage()"
                style="padding: 1% 2%; background-color: #6c63ff; color: white; border: none; border-radius: 0.5vw; font-size: 1vw; cursor: pointer;">发送</button>
              <!-- 更多功能按钮（不实现功能） -->
              <button style="font-size: 1vw;">📎</button>
              <button style="font-size: 1vw;">🎤</button>
              <button style="font-size: 1vw;">🔗</button>
            </div>
          </div>
        </div>

        <div id="thirdrelaxpage" class="thirdpage">
          <button class="thirdbackbtn" onclick="thirdShowPage('thirdmainmenu')">返回</button>
          <div>舒缓放松全屏页面内容</div>
        </div>

        <div id="thirdmeditationpage" class="thirdpage">
          <button class="thirdbackbtn" onclick="thirdShowPage('thirdmainmenu')">返回</button>
          <div>静坐全屏页面内容</div>
        </div>

        <div id="thirdsleeppage" class="thirdpage">
          <button class="thirdbackbtn" onclick="thirdShowPage('thirdmainmenu')">返回</button>

          <!-- 全屏模式 - 专注睡眠 -->
          <div class="third-fullscreen third-focus-sleep-screen" style="display: none;">
            <button class="third-back-button" onclick="thirdShowPage('thirdmainmenu')">返回</button>
            <div class="third-focus-sleep-container">
              <div class="third-timer-section">
                <div class="third-timer-display">00:00:00</div>
                <div class="third-timer-controls">
                  <button class="third-timer-button" id="third-start-timer">开始</button>
                  <button class="third-timer-button" id="third-stop-timer">结束</button>
                  <button class="third-timer-button" id="third-submit-timer">提交</button>
                </div>
              </div>
              <div class="third-progress-section">
                <div class="third-progress-container">
                  <div class="third-progress-bar" id="third-sleep-progress"></div>
                  <div class="third-progress-labels">
                    <span class="thirddream">美梦</span>
                    <span class="thirddream">睡眠较好</span>
                    <span class="thirddream">平静的睡眠</span>
                    <span class="thirddream">睡眠较差</span>
                    <span class="thirddream">失眠</span>
                  </div>
                </div>
                <div class="third-rating-display">评级: </div>
              </div>
            </div>
          </div>

          <!-- 全屏模式 - 略微小憩 -->
          <div class="third-fullscreen third-nap-screen" style="display: none;">
            <button class="third-back-button" onclick="thirdShowPage('thirdmainmenu')"> 返回</button>
            <div class="third-nap-container">
              <h2>小憩</h2>
              <div class="third-nap-timer-display">30 分钟</div>
              <div class="third-nap-slider-container">
                <div class="third-nap-slider" id="third-nap-slider">
                  <div class="third-nap-slider-handle"></div>
                </div>
              </div>
              <button class="third-nap-start-button" id="third-start-nap">开始小憩</button>
            </div>
          </div>

          <!-- 全屏模式 - AMSR -->
          <div class="third-fullscreen third-amsr-screen" style="display: none;">
            <button class="third-back-button" onclick="thirdShowPage('thirdmainmenu')">返回</button>
            <div class="third-amsr-container">
              <div class="third-amsr-cover">
                <!-- 这里放置AMSR封面图片 -->
                <img src="./src/45.avif" alt="AMSR封面" class="third-amsr-cover-image">
              </div>
              <div class="third-amsr-title">你好，世界</div>
              <div class="third-amsr-progress-container">
                <div class="third-amsr-progress-bar">
                  <div class="third-amsr-progress"></div>
                </div>
              </div>
              <div class="third-amsr-controls">
                <button class="third-amsr-button" id="third-prev-song">上一曲</button>
                <button class="third-amsr-button" id="third-play-pause">播放</button>
                <button class="third-amsr-button" id="third-next-song">下一曲</button>
              </div>
            </div>
          </div>

          <!-- 全屏模式 - 睡眠总结 -->
          <div class="third-fullscreen third-summary-screen" style="display: none;">
            <button class="third-back-button" onclick="thirdShowPage('thirdmainmenu')">返回</button>
            <div class="third-summary-container">
              <h2>睡眠周期分析</h2>
              <div class="third-chart-container">
                <canvas id="third-sleep-chart"></canvas>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- third -->

      <div id="rightforth" class="right">
        <div id="forthMoodModal">
          <div style="text-align:center">
            <p style="font-size:2.5vw;font-weight:bold">开始今日的音乐疗愈么？</p>
            <p style="font-size:1.8vw;margin:20px 0 40px">请选择你此刻的心情</p>
            <button class="moodBtn" onclick="forthChooseMood('joy')" id="iamjoy">喜</button>
            <button class="moodBtn" onclick="forthChooseMood('sad')" id="iamsad">悲</button>
            <button class="moodBtn" onclick="forthChooseMood('anger')" id="iamanger">怒</button>
          </div>
        </div>

        <div id="forthend" class="evaluation-wrapper" style="display: none;">
          <!-- Questions Area -->
          <div class="evaluation-questions">
            <div class="question-block">
              <p>你感觉你的情绪的缓解程度？</p>
              <div class="radio-group">
                <label><input type="radio" name="forthQ1" value="20">20分</label>
                <label><input type="radio" name="forthQ1" value="40">40分</label>
                <label><input type="radio" name="forthQ1" value="60">60分</label>
                <label><input type="radio" name="forthQ1" value="80">80分</label>
                <label><input type="radio" name="forthQ1" value="100">100分</label>
              </div>
            </div>
            <div class="question-block">
              <p>你感觉本次音乐疗愈的贴切程度？</p>
              <div class="radio-group">
                <label><input type="radio" name="forthQ2" value="20">20分</label>
                <label><input type="radio" name="forthQ2" value="40">40分</label>
                <label><input type="radio" name="forthQ2" value="60">60分</label>
                <label><input type="radio" name="forthQ2" value="80">80分</label>
                <label><input type="radio" name="forthQ2" value="100">100分</label>
              </div>
            </div>
            <div class="question-block">
              <p>你认为本次音乐疗愈的效果如何？</p>
              <div class="radio-group">
                <label><input type="radio" name="forthQ3" value="20">20分</label>
                <label><input type="radio" name="forthQ3" value="40">40分</label>
                <label><input type="radio" name="forthQ3" value="60">60分</label>
                <label><input type="radio" name="forthQ3" value="80">80分</label>
                <label><input type="radio" name="forthQ3" value="100">100分</label>
              </div>
            </div>
            <input type="button" value="返回" id="forthreturn" onclick="forthreturn()" class="forthbutton styled-button">
          </div>

          <!-- Control Panel -->
          <div class="evaluation-controls">
            <button onclick="forthSubmitEvaluation()" class="styled-button">提交评价</button>
            <div id="forthSubmitProgress" class="progress-bar">
              <div id="forthSubmitBar" class="progress-bar-fill"></div>
            </div>
            <p id="forthSubmitStatus" class="submit-status-text"></p>
            <button onclick="forthEndSession()" class="styled-button">结束本次疗愈</button>
          </div>
        </div>

        <div id="forthmain" style="display: none;">

          <div id="forthHeader" style="text-align: center; margin-top: 2%;">
            <h1 style="font-size: 25px; font-weight: bold;">音乐疗愈</h1>
            <p style="font-size: 1.5vw;">过去的一切，今天已然成为安乐</p>
          </div>

          <!-- Player Section -->
          <div id="forthPlayerBar"
            style="width: 100%; height: 15%; display: flex; align-items: center; justify-content: space-between;border:1px solid black">
            <!-- Cover -->
            <div id="forthMusicCover" style="width: 15%; height: 100%; background-color: #ddd; margin-left: 1%;">
            </div>

            <!-- Player Box -->
            <div id="forthPlayerBox"
              style="width: 60%; height: 80%; display: flex; flex-direction: column; justify-content: space-between;">
              <!-- Progress Bar -->
              <div id="forthProgressContainer"
                style="width: 100%; height: 20%; background-color: grey; cursor: pointer;">
                <div id="forthProgressBar" style="width: 0%; height: 100%; background-color: lightblue;"></div>
              </div>

              <!-- Controls -->
              <div id="forthControls"
                style="width: 100%; display: flex; justify-content: space-around; align-items: center; height: 70%;">
                <div id="forthPrevBtn"></div>
                <div id="forthPlayPauseBtn"></div>
                <div id="forthNextBtn"></div>
              </div>
            </div>

            <!-- Evaluation Box -->
            <div id="forthEvalBox"
              style="width: 20%; height: 80%; margin-right: 1%; display: flex; flex-direction: column; justify-content: space-around;">
              <div style="text-align: center;" id="ilikeit" onclick="like()">喜欢这首</div>
              <div style="text-align: center;" id="idontlikeit" onclick="dislike()">不喜欢这首</div>
            </div>
          </div>

          <!-- Main Music Area -->
          <div id="forthMainMusic" style="width: 100%; height: 60%; text-align: center; padding-top: 3%;">

            <div id="forthMusicContent" style="display: none; width: 100%; height: 100%; display: flex;">
              <div id="forthMusicList" style="width: 50%; background-color: #f0f0f0;">
                <h3>线上音乐与此生</h3>
                <div id="forthmusicul">
                  <div class="forthmainmusicli">治愈旋律A
                    <div class="musicgo">
                      <img src="./src/21.png" title="点击播放" class="musicgoimggoing" id="playgoing" onclick="musicgo()">
                      <img src="./src/22.png" title="点赞" class="musicgoimg" onclick="thatisgood(0)">
                      <img src="./src/24.png" title="喜欢" class="musicgoimg" onclick="ilikeit(1)">
                    </div>
                  </div>
                  <div class="forthmainmusicli">轻柔钢琴B
                    <div class="musicgo">
                      <img src="./src/21.png" title="点击播放" class="musicgoimggoing" id="playgoing" onclick="musicgo()">
                      <img src="./src/22.png" title="点赞" class="musicgoimg" onclick="thatisgood(2)">
                      <img src="./src/24.png" title="喜欢" class="musicgoimg" onclick="ilikeit(3)">
                    </div>
                  </div>
                  <div class="forthmainmusicli">冥想音乐C
                    <div class="musicgo">
                      <img src="./src/21.png" title="点击播放" class="musicgoimggoing" id="playgoing" onclick="musicgo()">
                      <img src="./src/22.png" title="点赞" class="musicgoimg" onclick="thatisgood(4)">
                      <img src="./src/24.png" title="喜欢" class="musicgoimg" onclick="ilikeit(5)">
                    </div>
                  </div>
                  <div class="forthmainmusicli">治愈旋律A
                    <div class="musicgo">
                      <img src="./src/21.png" title="点击播放" class="musicgoimggoing" id="playgoing" onclick="musicgo()">
                      <img src="./src/22.png" title="点赞" class="musicgoimg" onclick="thatisgood(6)">
                      <img src="./src/24.png" title="喜欢" class="musicgoimg" onclick="ilikeit(7)">
                    </div>
                  </div>

                </div>
                <h4>你的喜欢</h4>
                <div id="yourlikeul">
                  <div class="yourlikeli" title="点击播放" onclick="likemusicgo()">a</div>
                  <div class="yourlikeli" title="点击播放" onclick="likemusicgo()">b</div>
                  <div class="yourlikeli" title="点击播放" onclick="likemusicgo()">c</div>
                  <div class="yourlikeli" title="点击播放" onclick="likemusicgo()">a</div>
                </div>
              </div>
              <div id="forthMusicOptions" style="width: 50%;">
                <div id="forthmusictile">情绪婉约电台</div>
                <div id="forthmusicoptiondiv"
                  style="display: flex; flex-wrap: wrap; justify-content: space-around; align-content: space-around;">
                  <div class="forthOptionBox" title="助眠脑波:点击播放音乐电台" id="option1" onclick="optionmusic(0)">助眠脑波</div>
                  <div class="forthOptionBox" title="助眠播客:点击播放音乐电台" id="option2" onclick="optionmusic(1)">助眠播客</div>
                  <div class="forthOptionBox" title="氛围冥想:点击播放音乐电台" id="option3" onclick="optionmusic(2)">氛围冥想</div>
                  <div class="forthOptionBox" title="自然声音:点击播放音乐电台" id="option4" onclick="optionmusic(3)">自然声音</div>
                  <div class="forthOptionBox" title="纯净音乐:点击播放音乐电台" id="option5" onclick="optionmusic(4)">纯净音乐</div>
                  <div class="forthOptionBox" title="长时单曲:点击播放音乐电台" id="option6" onclick="optionmusic(5)">长时单曲</div>
                </div>
              </div>
            </div>
            <div style="position:absolute; right:45px; bottom:0px; z-index:1">
              <button onclick="forthshowquestion()" class="forthbutton">结束</button>
            </div>




          </div>


        </div>


      </div>

      <!-- forth -->

      <div id="rightfifth" class="right">
        <div id="rightfifthhead">
          <div id="rightfifthtitle">
            <p id="fifthbigtitle">情绪日志</p>
            <p id="fifthlittletitle">为自己写下的情绪的梦</p>
          </div>
          <div id="user2">
            <div id="userup2">
              <div id="userupfirst2">root用户</div>
              <div id="userupsecond2" onclick="changebell()"></div>
            </div>
            <div id="userdown1">
              <div class="search-box">
                <input type="text" placeholder="搜索记录…" class="search-input">
                <i class="fas fa-search search-icon"></i>
              </div>
            </div>
          </div>
        </div>

        <div id="rightfifthbook">
          <div id="rightfifthdaily">
            <div id="fifthContainer">
              <!-- 顶部每日一句 -->
              <div id="fifthTopQuote">
                “坚持是一种信念，你已经很棒了！”
              </div>
              <!-- 中间主内容 -->
              <div id="fifthMainContent">

                <!-- 左侧日期与情绪提示 -->
                <div id="fifthLeftPanel">
                  <div id="fifthDateInfo">2025年4月</div>
                  <div id="fifthDateNumber">20</div>
                  <div id="fifthEmotionTip">
                    给自己一点空间，允许情绪自由流动。<br>深呼吸，从容面对今天。
                  </div>
                </div>

                <!-- 右侧日历选择 -->
                <div id="fifthRightPanel">
                  <div id="fifthDatePickerLabel">选择一个日期：</div>
                  <input id="fifthDatePicker" type="date" />
                </div>

              </div>

              <!-- 底部功能按钮 -->
              <div id="fifthFooter">
                <div class="fifthActionButton">
                  <img src="./src/37.png" alt="日志图标" />
                  管理日志

                </div>
                <div class="fifthActionButton">
                  <img src="./src/38.png" alt="趋势图标" />
                  情绪趋势
                </div>
                <div class="fifthActionButton">
                  <img src="./src/39.png" alt="说明图标" />
                  添加说明
                </div>
              </div>

            </div>

          </div>

          <div id="rightfifthmain">
            <div id="rightfifthmainfirst">
              <div class="rightfifthmainitem" onclick="fifthmain(0)">情绪记录</div>
              <div class="rightfifthmainitem" onclick="fifthmain(1)">情绪变化</div>
              <div class="rightfifthmainitem" onclick="fifthmain(2)">趋势图表</div>
              <div class="rightfifthmainitem" onclick="fifthmain(3)">情绪追踪</div>
            </div>

            <div id="rightfifthmainsecond">
              <div class="fifthmainsecondimg"></div>
              <div class="fifthmainsecondimg"></div>
              <div class="fifthmainsecondimg"></div>
              <div class="fifthmainsecondimg"></div>
            </div>
          </div>
        </div>

        <div id="rightfifthable">
          <!-- 情绪记录 -->
          <div id="fifthEmotionRecord" class="fifthSection"
            style="display: block; width: 100%; height: 100%; padding: 15px; box-sizing: border-box;">
            <h2 style="margin-bottom: 10px; color: #333;">开始记录</h2>
            <textarea id="fifthTextInput" placeholder="写下此刻的情绪..."
              style="width: 100%; height: 120px; resize: none; border: 1px solid #ccc; border-radius: 6px; padding: 8px; font-size: 14px;"></textarea>
            <div style="margin-top: 10px; display: flex; flex-wrap: wrap; gap: 10px;">
              <button class="fifthButton">保存</button>
              <button class="fifthButton">重新输入</button>
              <button class="fifthButton">保存为草稿</button>
              <button class="fifthButton">表情</button>
              <button class="fifthButton">颜色选择</button>
            </div>

            <h3 style="margin-top: 20px; color: #333;">记录历史</h3>
            <div id="fifthViewEdit"
              style="display: flex; flex-direction: column; gap: 10px; max-height: 100px; overflow-y: auto;">
              <div class="fifthRecordItem">
                <span>2025-07-30：今天心情很好，阳光明媚。</span>
                <div class="fifthRecordActions">
                  <button class="fifthActionBtn">编辑</button>
                  <button class="fifthActionBtn">删除</button>
                </div>
              </div>
            </div>

            <div id="fifthImageRecordEntry" style="margin-top: 10px;">
              <button class="fifthButton">上传图片记录</button>
            </div>
          </div>

          <!-- 情绪变化 -->
          <div id="fifthEmotionChange" class="fifthSection"
            style="display: none; width: 100%; height: 100%; padding: 15px; overflow-y: auto; box-sizing: border-box;">
            <h2 style="color: #333;">情绪变化</h2>
            <div id="fifthTimeline" class="fifthModuleBox">时间轴展示（示意）</div>
            <div id="fifthWordCloud" class="fifthModuleBox">情绪词云（今日/本周）</div>
            <div id="fifthDailyReview" class="fifthModuleBox">
              <strong>今日回顾：</strong><br>
              <span>AI摘要：今天你多次提到“忙碌”、“期待”，整体积极。</span><br>
              情绪雷达图（占位）
            </div>
            <div id="fifthRelationAnalysis" class="fifthModuleBox">
              关联分析：<br>
              <ul>
                <li>触发因素：工作、天气</li>
                <li>身体反应：疲劳、胃紧张</li>
              </ul>
            </div>
            <div style="margin-top: 10px;">
              <button class="fifthButton">快速编辑</button>
              <button class="fifthButton">删除</button>
              <button class="fifthButton">设为私密</button>
            </div>
          </div>

          <!-- 趋势图表 -->
          <div id="fifthTrendCharts" class="fifthSection"
            style="display: none; width: 100%; height: 100%; padding: 15px; overflow-y: auto; box-sizing: border-box;">
            <h2 style="color: #333;">趋势图表</h2>
            <div class="fifthModuleBox fifthChartLink" data-chart="lineChart" onclick="fifthgotoimg(0)">折线图：情绪强度随时间
            </div>
            <div class="fifthModuleBox fifthChartLink" data-chart="areaChart" onclick="fifthgotoimg(1)">面积堆叠图：情绪结构 Pos
              /
              Neu / Neg</div>
            <div class="fifthModuleBox fifthChartLink" data-chart="heatMap" onclick="fifthgotoimg(2)">日历热力图：颜色表示情绪强度均值
            </div>
            <div style="margin-top: 10px;">
              <button class="fifthButton">导出 PNG</button>
              <button class="fifthButton">导出 SVG</button>
              <button class="fifthButton">一键分享</button>
            </div>
          </div>


          <!-- 折线图界面 -->
          <div id="fifthLineChartView" class="fifthSectionchart"
            style="display: none; width: 100%; height: 100%; padding: 10px; box-sizing: border-box;">
            <canvas class="fifthcanvas" id="fifthLineChart" style="width:80%; height:80%;display: block;"></canvas>
            <button class="fifthButtonreturn" onclick="fifthBackToTrend(0)">返回</button>
          </div>

          <!-- 面积图界面 -->
          <div id="fifthAreaChartView" class="fifthSectionchart"
            style="display: none; width: 100%; height: 100%; padding: 10px; box-sizing: border-box;">
            <canvas class="fifthcanvas" id="stackedArea"></canvas>
            <button class="fifthButtonreturn" onclick="fifthBackToTrend(1)">返回</button>
          </div>

          <!-- 热力图界面 -->
          <div id="fifthHeatMapView" class="fifthSectionchart"
            style="display: none; width: 100%; height: 100%; padding: 10px; box-sizing: border-box;">
            <div id="wrapper" class="fifthcanvas">
              <!-- 日期索引 -->
              <div id="index">
                <input type="date" id="datePicker" min="2026-01-01" max="2026-12-31">
                <button onclick="jumpToDate()">跳转</button>
              </div>

              <!-- 自适应 SVG -->
              <svg id="cal" viewBox="0 0 1000 200" preserveAspectRatio="xMidYMid meet"></svg>
            </div>

            <!-- 弹窗 -->
            <div id="dlg" class="hidden">
              <div id="box">
                <h3 id="dlgTitle"></h3>
                <div id="dlgDate" style="font-size:12px;color:#555;margin-bottom:8px"></div>
                <label>情绪评分 1-5：</label>
                <select id="scoreSel">
                  <option value="1">1 低落</option>
                  <option value="2">2 较差</option>
                  <option value="3">3 平静</option>
                  <option value="4">4 良好</option>
                  <option value="5">5 愉悦</option>
                </select>
                <label>备注：</label>
                <textarea id="noteTxt" rows="3"></textarea>
                <div>
                  <button id="save">保存</button>
                  <button id="del" class="hidden">删除</button>
                  <button id="cancel">取消</button>
                </div>
              </div>
            </div>
            <button class="fifthButtonreturn" onclick="fifthBackToTrend(2)">返回</button>
          </div>


          <!-- 情绪追踪 -->
          <div id="fifthEmotionTrack" class="fifthSection"
            style="display: none; width: 100%; height: 100%; padding: 10px; overflow-y: auto; box-sizing: border-box;">
            <h2 style="color: #333;">情绪追踪</h2>
            <div class="fifthModuleBox">目标设定：如「本月积极情绪≥60%」</div>
            <div class="fifthModuleBox">习惯打卡：冥想、运动、饮水等（与情绪曲线叠加）</div>
            <div class="fifthModuleBox">提醒系统：Web Push + 桌面通知</div>
            <div class="fifthModuleBox">成就体系：连续记录 7 天 → 解锁「情绪守望者」勋章</div>
          </div>

        </div>


      </div>




      <!-- fifth -->

    </div>
    <!--right-->




    <!--这是all的底部-->
  </div>

</body>
<script>
  window.onload = function () {
    var k = document.getElementsByClassName("leftmainli")
    for (var i = 0; i < k.length; i++) {
      k[i].classList.add('animate')
    }
    leftmainlichange(0)
    document.getElementsByClassName("fifthmainsecondimg")[0].style.opacity = 1
  }

  var third_sleep_choose = false
  function leftmainlichange(n) {
    document.querySelectorAll('.leftmainli')
      .forEach(li => li.classList.remove('leftliafterclick'));
    document.querySelectorAll('.leftmainli')[n]
      .classList.add('leftliafterclick');
    var k = document.getElementsByClassName("leftmainli")
    k[n].classList.add('clickshake')
    setTimeout(() => {
      k[n].classList.remove("clickshake")
    }, 300)
    changeright(n)
    if (n == 0) {
      emotionBar.reset()
      emotionBar.update()
      emothionline.reset()
      emothionline.update()
      emotionPie.reset()
      emotionPie.update()
      firstrightlichange(1)
      const items = document.querySelectorAll('.rightfirstmainrightli');

      items.forEach(item => {
        const focusEl = item.querySelector('.firstmainsayfocus');
        const mathEl = item.querySelector('.firstmainsaymath');
        const target = parseInt(focusEl.textContent, 10);
        focusEl.textContent = '0';

        animateNumber(focusEl, target, 2500, () => {
          // ✅ 动画结束后加上 fade-in 类
          mathEl.classList.remove('animate');
          // var el = mathEl
          // void el.offsetWidth;
          // el.classList.add('animate');
          // firstrightlichange(0)
        });
      })
    }
    else if (n == 1) {
      emotionChart.reset()
      emotionChart.update()
      playRightSecondAnimations();

    }


    else if (n == 2) {
      var ok = document.getElementById("right")
      ok.style.backgroundColor = "#ffffffe2"
    }
    else if (n == 3) {
      forthResetPage();
    }
    else if (n == 4) {
      var ok = document.getElementById("right")
      ok.style.backgroundColor = "#bc1fff28"
      fifthShowAnimation()
    }


  }
  function changeright(n) {
    var k = document.getElementsByClassName("right")
    for (var i = 0; i < k.length; i++) {
      k[i].style.display = "none"
      k[i].style.visibility = "visible"
    }
    k[n].style.display = "block"
    k[n].style.visibility = "visible"
    // if (n == 1) {
    //   k[n].style.display = "flex"
    // }
  }
  function firstrightlichange(n) {
    var k = document.getElementsByClassName('rightfirstmainrightli')
    if (n == 1) {
      for (var i = 0; i < k.length; i++) {
        k[i].classList.add('animate')
      }
    }
    else {
      for (var i = 0; i < k.length; i++) {
        k[i].classList.remove('animate')
        void el.offsetWidth;
      }
    }
  }
  var bellnum = 0
  function changebell() {
    var k = document.getElementById("userupsecond")
    if (bellnum % 2 == 0) {

      k.style.backgroundImage = "url(./src/15.png)"

    }
    else {
      k.style.backgroundImage = "url(./src/13.png)"
    }
    bellnum += 1
  }


  //数字变化
  function animateNumber(element, target, duration = 2500, onComplete = null) {
    let start = 0;
    const stepTime = 15;
    const steps = duration / stepTime;
    const increment = target / steps;

    const timer = setInterval(() => {
      start += increment;
      if (start >= target) {
        start = target;
        clearInterval(timer);
        if (onComplete) onComplete(); // ✅ 动画完成后回调
      }
      element.textContent = Math.floor(start);
    }, stepTime);
  }

  document.addEventListener("DOMContentLoaded", () => {
    const items = document.querySelectorAll('.rightfirstmainrightli');

    items.forEach(item => {
      const focusEl = item.querySelector('.firstmainsayfocus');
      const mathEl = item.querySelector('.firstmainsaymath');
      const target = parseInt(focusEl.textContent, 10);
      focusEl.textContent = '0';

      animateNumber(focusEl, target, 2500, () => {
        // ✅ 动画结束后加上 fade-in 类
        mathEl.classList.add('fade-in');
      });
    });
  });




  const testup = document.getElementById('testup');
  const testin = document.getElementById('testin');

  ['dragenter', 'dragover'].forEach(evt =>
    testin.addEventListener(evt, e => {
      e.preventDefault();
      testup.style.backgroundColor = '#ccc';
    })
  );
  ['dragleave', 'drop'].forEach(evt =>
    testin.addEventListener(evt, () => {
      testup.style.backgroundColor = '';
    })
  );


  const bar = document.createElement('div');
  const nameBox = document.createElement('div');
  Object.assign(bar.style, {
    width: 0, height: '6px', background: '#55ff4c',
    position: 'absolute', bottom: 0, left: 0, transition: 'width 1.2s ease-out'
  });
  Object.assign(nameBox.style, { marginTop: '8px', fontSize: '14px', color: '#333' });
  testup.style.position = 'relative';
  testup.appendChild(bar);
  testup.appendChild(nameBox);

  var file_name = ''
  function playUpload(filename) {
    bar.style.transition = 'none';
    bar.style.width = 0;
    nameBox.textContent = '';

    bar.offsetHeight;
    bar.style.transition = 'width 1.2s ease-out';
    bar.style.width = '100%';
    setTimeout(() => nameBox.textContent = '已选择：' + filename, 1200);
    file_name = filename
  }
  testin.addEventListener('change', () => {
    const file = testin.files[0];
    if (file) playUpload(file.name);
  });

  testin.addEventListener('drop', e => {
    e.preventDefault();
    testin.files = e.dataTransfer.files;
    if (testin.files[0]) playUpload(testin.files[0].name);
  });

  function buttoncheck() {
    if (file_name == '') {
      alert("请传入文件！")
      return
    }
  }

  var secondmain = document.getElementsByClassName("secondmainheadli")
  function changesecondmain(n) {
    var a = document.getElementById("secondmainleftsay1")
    var b = document.getElementById("secondmainleftsay2")
    var c = document.getElementById("secondmainleftsay3")
    var d = document.getElementById("secondmainbottomsay")
    for (var i = 0; i < secondmain.length; i++) {
      secondmain[i].style.backgroundColor = "#ffffff00"
    }
    secondmain[n].style.backgroundColor = "#43fff2"
    if (n == 0) {
      a.textContent = "透过对字里行间的行文的分析串联起一个个无声的文字"
      b.textContent = "织成细腻而婉转的笔者的弦外之音"
      c.textContent = "从而剖析出，每一句所蕴含的情绪的意义"
      d.textContent = "请确认上传的是文本数据！"
    }
    else if (n == 1) {
      a.textContent = "计算机……冰冷的机器么，不，它们也有视觉"
      b.textContent = "有着我们给予它们的，关于图片和情绪的记忆"
      c.textContent = "通过这些记忆，再去读懂我们的图片，便能得出其中思绪……"
      d.textContent = "请确认上传的是图像数据！"
    }
    else if (n == 2) {
      a.textContent = "因能量而颤动并向外传送波纹的信息"
      b.textContent = "当计算机学会了这些信息承载的意义"
      c.textContent = "它们也能够以数据分析和数据库为我们去阅读这些频率"
      d.textContent = "请确认上传的是音频数据！"
    }
    else if (n == 3) {
      a.textContent = "我们当然看不到我们悲喜之际的脑电"
      b.textContent = "将其捕捉，交给计算机吧"
      c.textContent = "我们的系统能够很快地给出答案"
      d.textContent = "请确认上传的是脑电相关数据！"
    }
  }

  //入场动画
  function playRightSecondAnimations() {
    const head = document.getElementById('rightsecondhead');
    const main = document.getElementById('rightsecondmain');
    const left = document.getElementById('secondheadleft');
    const user = document.getElementById('user1');
    const mainLeft = document.getElementById('secondmainleft');
    const mainRight = document.getElementById('secondmainright');

    // 移除旧类
    [head, main, left, user, mainLeft, mainRight].forEach(el => {
      el.classList.remove('animate-slide-up', 'animate-from-left', 'animate-from-right', 'animate-slide-down');
      void el.offsetWidth; // 强制重绘以重启动画
    });

    head.classList.add('animate-slide-up');
    main.classList.add('animate-slide-up');
    left.classList.add('animate-from-right');
    user.classList.add('animate-from-left');
    mainLeft.classList.add('animate-slide-down');
    mainRight.classList.add('animate-slide-down');
  }



  //进度条

  function buttoncheck() {
    if (file_name === '') {
      alert("请传入文件！");
      return;
    }

    const progressTitles = ['读取数据', '匹配数据库', '大模型分析'];
    const waitingTexts = ['等待读取', '等待匹配', '等待分析'];
    const runningTexts = ['正在读取', '正在匹配', '正在分析'];
    const doneTexts = ['完成读取', '完成匹配', '完成分析'];

    const container = document.getElementById('secondmainright');
    const progressDivs = document.querySelectorAll('.secondmainprogress');

    // 清除旧内容并设置初始状态
    progressDivs.forEach((div, i) => {
      div.innerHTML = '';
      div.style.display = 'none';
      div.classList.remove('animate-rise');
      void div.offsetWidth;
    });

    const oldBtn = document.getElementById('showresultbtn');
    if (oldBtn) oldBtn.remove();

    // 添加滑入动画（0.2s 间隔）
    progressDivs.forEach((div, i) => {
      setTimeout(() => {
        div.style.display = 'flex';
        div.classList.add('animate-rise');

        div.style.flexDirection = 'column';
        div.style.alignItems = 'center';

        const title = document.createElement('div');
        title.className = 'progress-title';
        title.innerText = progressTitles[i];

        const barContainer = document.createElement('div');
        barContainer.style.width = '100%';
        barContainer.style.height = '40px';
        barContainer.style.backgroundColor = '#eee';
        barContainer.style.borderRadius = '10px';
        barContainer.style.position = 'relative';
        barContainer.style.overflow = 'visible';

        const bar = document.createElement('div');
        bar.className = 'progress-bar-fill';
        bar.style.height = '100%';
        bar.style.width = '0%';
        bar.style.backgroundColor = '#55ff4c';
        bar.style.transition = 'width 2.5s ease';

        const statusText = document.createElement('div');
        statusText.className = 'progress-text';
        statusText.innerText = waitingTexts[i];

        barContainer.appendChild(bar);
        barContainer.appendChild(statusText);

        div.appendChild(title);
        div.appendChild(barContainer);
      }, i * 200); // stagger 200ms
    });

    // 等待全部滑入后启动进度条动画
    setTimeout(() => {
      function animateBar(i) {
        if (i >= progressDivs.length) {
          const resultBtn = document.createElement('button');
          resultBtn.id = 'showresultbtn';
          resultBtn.innerText = '显示结果';
          container.appendChild(resultBtn);
          resultBtn.style.display = "block"
          return;
        }

        const bar = progressDivs[i].querySelector('.progress-bar-fill');
        const text = progressDivs[i].querySelector('.progress-text');

        text.innerText = runningTexts[i];
        bar.offsetHeight;
        bar.style.width = '100%';

        setTimeout(() => {
          text.innerText = doneTexts[i];
          setTimeout(() => animateBar(i + 1), 1000);
        }, 2500);
      }

      animateBar(0);
    }, 3 * 200 + 200); // 滑入完再开始动画
  }



  //第三页
  function longdaygo() {
    alert("该部分还待优化/嵌入/引进，敬请期待！")
  }
  function thirdShowPage(pageId) {
    const pages = [
      "thirdmainmenu",
      "thirdinteractivepage",
      "thirdrelaxpage",
      "thirdmeditationpage",
      "thirdsleeppage"
    ];
    if (pageId == "thirdsleeppage" && third_sleep_choose == false) {
      alert("请选择你要去往的功能！")
      return
    }
    pages.forEach(id => {
      document.getElementById(id).style.display = (id === pageId) ? "flex" : "none";
    });
    if (pageId == "thirdmainmenu") {
      document.getElementById("thirdsleep").style.backgroundImage = "none"
      third_sleep_choose = false
    }

  }

  // 默认显示主页面
  thirdShowPage("thirdmainmenu");

  // 自动为每个功能格子插入四角
  window.addEventListener("DOMContentLoaded", () => {
    const boxes = document.querySelectorAll(".thirdbox");
    boxes.forEach(box => {
      ["topleft", "topright", "bottomleft", "bottomright"].forEach(pos => {
        const div = document.createElement("div");
        div.classList.add("thirdcorner", pos);
        box.appendChild(div);
      });
    });
  });

  //交互式情绪调节
  /*以下是全屏的 */
  function thirdSendMessage() {
    const input = document.getElementById("thirdchatinput");
    const chatBody = document.getElementById("thirdchatbody");
    const text = input.value.trim();

    if (!text) {
      alert("请输入信息！");
      return;
    }

    // 添加用户消息
    const userMsg = document.createElement("div");
    userMsg.style.alignSelf = "flex-end";
    userMsg.style.display = "flex";
    userMsg.style.alignItems = "center";
    userMsg.innerHTML = `
    <div style="background-color: #6c63ff; color: white; border-radius: 10px; padding: 0.5vw 1vw; margin-right: 0.8vw;">${text}</div>
    <img src="./src/12.png" style="width: 3vw; height: 3vw; border-radius: 50%;">
  `;
    chatBody.appendChild(userMsg);

    // 添加AI回复
    const aiMsg = document.createElement("div");
    aiMsg.style.alignSelf = "flex-start";
    aiMsg.style.display = "flex";
    aiMsg.style.alignItems = "center";
    aiMsg.innerHTML = `
    <img src="./src/42.png" style="width: 3vw; height: 3vw; border-radius: 50%; margin-right: 0.8vw;">
    <div style="background-color: #e0e0e0; border-radius: 10px; padding: 0.5vw 1vw;">
      你好，用户，很高兴遇见你，当前功能正在维护，期待以后的相遇！
    </div>
  `;
    setTimeout(() => {
      chatBody.appendChild(aiMsg);
      chatBody.scrollTop = chatBody.scrollHeight;
    }, 300); // 模拟响应延迟

    input.value = "";
    chatBody.scrollTop = chatBody.scrollHeight;
  }

  /*以下是小窗的 */

  // 获取 DOM 元素
  const input = document.querySelector('#thirdfirsttext input');
  const sendBtn = document.querySelector('#thirdfirsttext button');
  const chatBox = document.querySelector('#thirdinteractivepreview > div:nth-child(2)');

  // 启用输入框和按钮
  input.disabled = false;
  sendBtn.disabled = false;

  // 绑定发送函数
  function sendMessage() {
    const text = input.value.trim();
    if (!text) return;

    // 创建用户气泡
    const userBubble = document.createElement('div');
    userBubble.style.alignSelf = 'flex-end';
    userBubble.style.display = 'flex';
    userBubble.style.alignItems = 'center';
    userBubble.innerHTML = `
      <div style="background-color: #6c63ff; color: white; border-radius: 10px; padding: 0.3vw 0.6vw; margin-right: 0.5vw;">
        ${text}
      </div>
      <img src="./src/12.png" style="width: 1.5vw; height: 1.5vw; border-radius: 50%;">

    `;

    chatBox.appendChild(userBubble);

    // 模拟 AI 回复（可替换为接口）
    setTimeout(() => {
      const aiBubble = document.createElement('div');
      aiBubble.style.alignSelf = 'flex-start';
      aiBubble.style.display = 'flex';
      aiBubble.style.alignItems = 'center';
      aiBubble.innerHTML = `
        <img src="./src/42.png" style="width: 1.5vw; height: 1.5vw; border-radius: 50%; margin-right: 0.5vw;">
        <div style="background-color: #e0e0e0; border-radius: 10px; padding: 0.3vw 0.6vw;">
          收到：“${text}”，我会为你解忧。
        </div>
      `;
      chatBox.appendChild(aiBubble);
      chatBox.scrollTop = chatBox.scrollHeight; // 滚动到底部
    }, 500);

    input.value = '';
    chatBox.scrollTop = chatBox.scrollHeight; // 滚动到底部
  }

  // 事件监听
  sendBtn.addEventListener('click', sendMessage);
  input.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') sendMessage();
  });




  /*睡眠 */
  document.addEventListener('DOMContentLoaded', function () {
    // 小窗口模式按钮事件
    var ck = document.getElementById("thirdsleep")
    document.getElementById('third-focus-sleep').addEventListener('click', function () {
      document.querySelector('.third-small-mode').style.display = 'none';
      document.querySelector('.third-focus-sleep-screen').style.display = 'block';
      ck.style.backgroundImage = "url(./src/44.png)"
      third_sleep_choose = true
    });

    document.getElementById('third-nap').addEventListener('click', function () {
      document.querySelector('.third-small-mode').style.display = 'none';
      document.querySelector('.third-nap-screen').style.display = 'block';
      ck.style.backgroundImage = "url(./src/44.png)"
      third_sleep_choose = true
    });

    document.getElementById('third-amsr').addEventListener('click', function () {
      document.querySelector('.third-small-mode').style.display = 'none';
      document.querySelector('.third-amsr-screen').style.display = 'block';
      ck.style.backgroundImage = "url(./src/44.png)"
      third_sleep_choose = true
    });

    document.getElementById('third-summary').addEventListener('click', function () {
      document.querySelector('.third-small-mode').style.display = 'none';
      document.querySelector('.third-summary-screen').style.display = 'block';
      ck.style.backgroundImage = "url(./src/44.png)"
      third_sleep_choose = true
      initializeSleepChart();
    });

    // 返回按钮事件
    const backButtons = document.querySelectorAll('.third-back-button');
    backButtons.forEach(button => {
      button.addEventListener('click', function () {
        document.querySelectorAll('.third-fullscreen').forEach(screen => {
          screen.style.display = 'none';
        });
        document.querySelector('.third-small-mode').style.display = 'block';
      });
    });

    // 专注睡眠功能
    const timerDisplay = document.querySelector('.third-timer-display');
    const startButton = document.getElementById('third-start-timer');
    const stopButton = document.getElementById('third-stop-timer');
    const submitButton = document.getElementById('third-submit-timer');
    const progressBar = document.getElementById('third-sleep-progress');
    const ratingDisplay = document.querySelector('.third-rating-display');

    let timer = null;
    let seconds = 0;
    let isRunning = false;

    startButton.addEventListener('click', function () {
      if (!isRunning) {
        isRunning = true;
        timer = setInterval(function () {
          seconds++;
          updateTimerDisplay();
        }, 1000);
      }
    });

    stopButton.addEventListener('click', function () {
      if (isRunning) {
        clearInterval(timer);
        isRunning = false;
      }
    });

    submitButton.addEventListener('click', function () {
      if (!isRunning) {
        progressBar.style.height = '0%';
        // 模拟评级 (这里随机选择评级)
        const ratings = ['失眠', '睡眠较差', '平静的睡眠', '睡眠较好', '美梦'];
        const ratingIndex = Math.floor(Math.random() * ratings.length);
        const rating = ratings[ratingIndex];

        // 计算进度条高度 (0-100%)
        const progressHeight = (ratingIndex + 1) * 20;

        // 设置进度条动画
        progressBar.style.height = `${progressHeight}%`;

        // 更新评级显示
        ratingDisplay.textContent = `评级: ${rating}`;

        // 2.5秒后重置计时器
        setTimeout(function () {
          seconds = 0;
          updateTimerDisplay();

          ratingDisplay.textContent = '评级: ' + rating;
        }, 2500);
      }
    });

    function updateTimerDisplay() {
      const hours = Math.floor(seconds / 3600);
      const minutes = Math.floor((seconds % 3600) / 60);
      const secs = seconds % 60;

      timerDisplay.textContent =
        `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }

    // 略微小憩功能
    const napSlider = document.getElementById('third-nap-slider');
    const napSliderHandle = document.querySelector('.third-nap-slider-handle');
    const napTimerDisplay = document.querySelector('.third-nap-timer-display');
    const startNapButton = document.getElementById('third-start-nap');

    let napMinutes = 30;
    let isDragging = false;
    let napTimer = null;

    // 初始化滑块位置
    updateSliderPosition();

    napSlider.addEventListener('mousedown', startDrag);
    document.addEventListener('mousemove', drag);
    document.addEventListener('mouseup', endDrag);

    napSlider.addEventListener('touchstart', startDrag);
    document.addEventListener('touchmove', drag);
    document.addEventListener('touchend', endDrag);

    function startDrag(e) {
      isDragging = true;
      updateSlider(e);
      e.preventDefault();
    }

    function drag(e) {
      if (isDragging) {
        updateSlider(e);
        e.preventDefault();
      }
    }

    function endDrag() {
      isDragging = false;
    }

    function updateSlider(e) {
      const sliderRect = napSlider.getBoundingClientRect();
      let clientX;

      if (e.type.includes('touch')) {
        clientX = e.touches[0].clientX;
      } else {
        clientX = e.clientX;
      }

      let position = (clientX - sliderRect.left) / sliderRect.width;
      position = Math.max(0, Math.min(1, position));

      // 计算分钟数 (5-120分钟)
      napMinutes = Math.round(5 + position * 115);

      updateSliderPosition();
      updateNapTimerDisplay();
    }

    function updateSliderPosition() {
      const position = (napMinutes - 5) / 115;
      const sliderWidth = napSlider.offsetWidth;
      const handleWidth = napSliderHandle.offsetWidth;
      const maxLeft = sliderWidth - handleWidth;

      napSliderHandle.style.left = `${position * maxLeft}px`;
    }

    function updateNapTimerDisplay() {
      napTimerDisplay.textContent = `${napMinutes} 分钟`;
    }

    startNapButton.addEventListener('click', function () {
      if (!napTimer) {
        let remainingSeconds = napMinutes * 60;

        napTimer = setInterval(function () {
          remainingSeconds--;

          if (remainingSeconds <= 0) {
            clearInterval(napTimer);
            napTimer = null;
            alert('小憩结束');
            napMinutes = 30;
            updateSliderPosition();
            updateNapTimerDisplay();
          } else {
            const minutes = Math.floor(remainingSeconds / 60);
            const seconds = remainingSeconds % 60;
            napTimerDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
          }
        }, 1000);
      }
    });

    // AMSR功能
    const playPauseButton = document.getElementById('third-play-pause');
    const progress = document.querySelector('.third-amsr-progress');

    let isPlaying = false;

    playPauseButton.addEventListener('click', function () {
      isPlaying = !isPlaying;
      playPauseButton.textContent = isPlaying ? '暂停' : '播放';

      // 模拟进度条
      if (isPlaying) {
        let progressWidth = 0;
        const progressInterval = setInterval(function () {
          if (progressWidth >= 100 || !isPlaying) {
            clearInterval(progressInterval);
            if (progressWidth >= 100) {
              isPlaying = false;
              playPauseButton.textContent = '播放';
              progress.style.width = '0%';
            }
          } else {
            progressWidth += 0.5;
            progress.style.width = `${progressWidth}%`;
          }
        }, 100);
      }
    });

    // 睡眠总结图表
    function initializeSleepChart() {
      const ctx = document.getElementById('third-sleep-chart').getContext('2d');

      // 模拟睡眠数据
      const sleepStages = ['清醒', 'REM', '浅睡', '深睡'];
      const hours = Array.from({ length: 8 }, (_, i) => `${i}时`);

      // 随机生成睡眠数据
      const datasets = sleepStages.map((stage, i) => {
        const data = hours.map(() => Math.floor(Math.random() * 30) + 10);
        const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0'];

        return {
          label: stage,
          data: data,
          backgroundColor: colors[i],
          borderColor: colors[i],
          borderWidth: 1,
          fill: false
        };
      });

      const whatchart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: hours,
          datasets: datasets
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: '分钟'
              }
            },
            x: {
              title: {
                display: true,
                text: '时间'
              }
            }
          },
          plugins: {
            title: {
              display: true,
              text: '睡眠周期分析',
              font: {
                size: 18
              }
            },
            legend: {
              position: 'top'
            }
          }
        }
      });
      whatchart.reset()
      whatchart.update()
    }
  });


  //第三页睡眠
  // 全局变量
  let thirdsitMeditationStarted = false;
  let thirdsitRemainingTime = 300; // 5分钟（秒）
  let thirdsitTotalTime = 300;     // 总时间（秒）
  const thirdsitMinTime = 300;     // 5分钟
  const thirdsitMaxTime = 7200;    // 120分钟
  let thirdsitTimer = null;
  let thirdsitFeatures = [];

  // DOM 元素
  const thirdsitTimerDisplay = document.getElementById('thirdsittimerdisplay');
  const thirdsitProgressBar = document.getElementById('thirdsitprogressbar');
  const thirdsitMainArea = document.getElementById('thirdsitmainarea');

  // 初始化
  updateTimerDisplay();
  const thirdsitNotification = document.getElementById('thirdsitnotification');

  // 添加按钮事件监听器
  document.getElementById('thirdsitwhitenoise').addEventListener('click', addWhiteNoise);
  document.getElementById('thirdsitwaterreminder').addEventListener('click', addWaterReminder);
  document.getElementById('thirdsitmeditationmaterial').addEventListener('click', addMeditationMaterial);
  document.getElementById('thirdsitaddfive').addEventListener('click', addFiveMinutes);
  document.getElementById('thirdsitsubfive').addEventListener('click', subtractFiveMinutes);

  // 添加全局点击事件（用于静坐状态下的操作拦截）
  document.addEventListener('click', handleGlobalClick);
  // function thirdsitInit() {
  //   updateTimerDisplay();

  //   // 添加按钮事件监听器
  //   document.getElementById('thirdsitwhitenoise').addEventListener('click', addWhiteNoise);
  //   document.getElementById('thirdsitwaterreminder').addEventListener('click', addWaterReminder);
  //   document.getElementById('thirdsitmeditationmaterial').addEventListener('click', addMeditationMaterial);
  //   document.getElementById('thirdsitaddfive').addEventListener('click', addFiveMinutes);
  //   document.getElementById('thirdsitsubfive').addEventListener('click', subtractFiveMinutes);

  //   // 添加全局点击事件（用于静坐状态下的操作拦截）
  //   document.addEventListener('click', handleGlobalClick);
  // }

  // 更新倒计时显示

  function showNotification(message) {
    thirdsitNotification.textContent = message;
    thirdsitNotification.style.display = 'block';
    setTimeout(() => {
      thirdsitNotification.style.display = 'none';
    }, 3000);
  }

  function updateTimerDisplay() {
    const minutes = Math.floor(thirdsitRemainingTime / 60);
    const seconds = thirdsitRemainingTime % 60;
    thirdsitTimerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

    // 更新进度条（基于总时间）
    const progressPercentage = 100 - (thirdsitRemainingTime / thirdsitTotalTime * 100);
    thirdsitProgressBar.style.width = `${progressPercentage}%`;
  }

  // 添加白噪音模块
  var voice = false
  function addWhiteNoise() {
    if (thirdsitMeditationStarted) return;

    const featureDiv = document.createElement('div');
    featureDiv.className = 'thirdsitfeature';
    if (voice == false) {
      featureDiv.textContent = '白噪音已开启';
      voice = true
    }
    else {
      featureDiv.textContent = '白噪音已关闭'
      voice = false
    }
    thirdsitMainArea.appendChild(featureDiv);
    thirdsitFeatures.push('whitenoise');

    // 滚动到底部
    thirdsitMainArea.scrollTop = thirdsitMainArea.scrollHeight;
  }

  // 添加喝水提醒
  var drink = false
  function addWaterReminder() {
    if (thirdsitMeditationStarted) return;

    const featureDiv = document.createElement('div');
    featureDiv.className = 'thirdsitfeature';
    if (drink == false) {
      featureDiv.textContent = '喝水提醒已设置';
      drink = true
    }
    else {
      featureDiv.textContent = '喝水提醒取消';
      drink = false
    }

    thirdsitMainArea.appendChild(featureDiv);
    thirdsitFeatures.push('waterreminder');

    thirdsitMainArea.scrollTop = thirdsitMainArea.scrollHeight;
  }

  // 添加冥想材料
  var think = 1
  function addMeditationMaterial() {
    if (thirdsitMeditationStarted) return;

    const featureDiv = document.createElement('div');
    featureDiv.className = 'thirdsitfeature';
    featureDiv.textContent = '冥想材料已加载' + think + '份';
    think += 1
    thirdsitMainArea.appendChild(featureDiv);
    thirdsitFeatures.push('meditationmaterial');

    thirdsitMainArea.scrollTop = thirdsitMainArea.scrollHeight;
  }

  // 增加五分钟
  function addFiveMinutes() {
    if (thirdsitMeditationStarted) return;

    if (thirdsitTotalTime + 300 <= thirdsitMaxTime) {
      thirdsitTotalTime += 300;
      thirdsitRemainingTime += 300;
      updateTimerDisplay();
      showNotification('已增加5分钟');
    } else {
      showNotification('已达到最大时间（120分钟）');
    }
  }

  // 减少五分钟
  function subtractFiveMinutes() {
    if (thirdsitMeditationStarted) return;

    if (thirdsitTotalTime - 300 >= thirdsitMinTime) {
      thirdsitTotalTime -= 300;
      thirdsitRemainingTime -= 300;
      updateTimerDisplay();
      showNotification('已减少5分钟');
    } else {
      showNotification('已达到最小时间（5分钟）');
    }
  }

  // 全局点击处理
  function handleGlobalClick(e) {
    if (!thirdsitMeditationStarted) return;

    // 阻止所有按钮操作
    if (e.target.classList.contains('thirdsitbtn')) {
      e.preventDefault();
      e.stopPropagation();
      showNotification('静坐进行中，请勿操作');
    }
  }

  // 开始静坐函数（供外部调用）
  function thirdsitStartMeditation() {
    if (thirdsitMeditationStarted) {
      // 如果已经在静坐中，询问是否结束
      if (confirm('是否立即结束静坐？')) {
        thirdsitStopMeditation();
        showNotification('静坐已结束');
      }
      return;
    }

    if (thirdsitRemainingTime <= 0) {
      showNotification('请设置静坐时间');
      return;
    }

    thirdsitMeditationStarted = true;
    showNotification('静坐开始，请专注');

    // 开始倒计时
    thirdsitTimer = setInterval(() => {
      thirdsitRemainingTime--;
      updateTimerDisplay();

      if (thirdsitRemainingTime <= 0) {
        thirdsitStopMeditation();
        showNotification('静坐时间结束！');
      }
    }, 1000);
  }

  // 停止静坐
  function thirdsitStopMeditation() {
    clearInterval(thirdsitTimer);
    thirdsitMeditationStarted = false;

    // 重置时间
    thirdsitRemainingTime = thirdsitMinTime;
    thirdsitTotalTime = thirdsitMinTime;
    updateTimerDisplay();

    // 清空功能模块
    thirdsitMainArea.innerHTML = '';
    thirdsitFeatures = [];

    // 添加初始提示
    const welcomeDiv = document.createElement('div');
    welcomeDiv.className = 'thirdsitfeature';
    welcomeDiv.innerHTML = '<span class="thirdsitfeatureicon">🕊️</span>静坐已完成';
    thirdsitMainArea.appendChild(welcomeDiv);

    const tipDiv = document.createElement('div');
    tipDiv.className = 'thirdsitfeature';
    tipDiv.innerHTML = '<span class="thirdsitfeatureicon">💡</span>请从左侧选择功能开始新的静坐';
    thirdsitMainArea.appendChild(tipDiv);
  }


  //第三页游戏

  // // DOM元素
  // const gameContainer = document.getElementById('thirdrelax');
  // const startScreen = document.getElementById('thirdrelaxStartScreen');
  // const gameScreen = document.getElementById('thirdrelaxGameScreen');
  // const endScreen = document.getElementById('thirdrelaxEndScreen');
  // const startButton = document.getElementById('thirdrelaxStartButton');
  // const restartButton = document.getElementById('thirdrelaxRestartButton');
  // const bird = document.getElementById('thirdrelaxBird');
  // const scoreDisplay = document.getElementById('thirdrelaxScoreDisplay');
  // const finalScoreDisplay = document.getElementById('thirdrelaxFinalScore');
  // const ground = document.getElementById('thirdrelaxGround');

  // // 游戏变量
  // let gameHeight, gameWidth;
  // let birdTop = 50;
  // let gravity = 0.5;
  // let velocity = 0;
  // let gameRunning = false;
  // let score = 0;
  // let pipes = [];
  // let frameCount = 0;
  // let pipeInterval = 90; // 管道生成间隔

  // // 初始化游戏
  // function initGame() {
  //   // 获取游戏区域尺寸
  //   gameHeight = gameContainer.offsetHeight;
  //   gameWidth = gameContainer.offsetWidth;

  //   // 重置游戏状态
  //   birdTop = 50;
  //   velocity = 0;
  //   score = 0;
  //   pipes = [];
  //   frameCount = 0;

  //   // 更新分数显示
  //   scoreDisplay.textContent = score;

  //   // 重置小鸟位置
  //   bird.style.top = birdTop + '%';
  //   bird.style.transform = 'rotate(0deg)';

  //   // 清除所有管道
  //   const existingPipes = document.querySelectorAll('.thirdrelaxPipe');
  //   existingPipes.forEach(pipe => pipe.remove());

  //   // 创建云朵
  //   createClouds();
  // }

  // // 创建云朵装饰
  // function createClouds() {
  //   // 清除现有云朵
  //   const existingClouds = document.querySelectorAll('.thirdrelaxCloud');
  //   existingClouds.forEach(cloud => cloud.remove());

  //   for (let i = 0; i < 5; i++) {
  //     const cloud = document.createElement('div');
  //     cloud.className = 'thirdrelaxCloud';

  //     // 随机位置和大小
  //     const size = Math.random() * 10 + 5;
  //     cloud.style.width = size + '%';
  //     cloud.style.height = size * 0.6 + '%';
  //     cloud.style.top = Math.random() * 50 + 5 + '%';
  //     cloud.style.left = Math.random() * 100 + '%';

  //     gameScreen.appendChild(cloud);
  //   }
  // }

  // // 小鸟跳跃函数
  // function thirdrelaxJump() {
  //   if (!gameRunning) return;

  //   velocity = -8;
  //   bird.style.transform = 'rotate(-20deg)';

  //   // 添加跳跃动画效果
  //   bird.style.transition = 'transform 0.2s';

  //   // 短暂旋转后恢复
  //   setTimeout(() => {
  //     if (gameRunning) {
  //       bird.style.transform = 'rotate(0deg)';
  //     }
  //   }, 200);
  // }

  // // 更新小鸟位置
  // function updateBird() {
  //   velocity += gravity;
  //   birdTop += velocity * 0.15; // 降低下降速度

  //   // 限制小鸟不飞出顶部和底部
  //   if (birdTop < 0) {
  //     birdTop = 0;
  //     velocity = 0;
  //   }
  //   if (birdTop > 85) {
  //     birdTop = 85;
  //     endGame();
  //   }

  //   bird.style.top = birdTop + '%';
  // }

  // // 创建管道
  // function createPipe() {
  //   const pipeGap = 25; // 管道间隙百分比
  //   const minTop = 15;  // 顶部管道最小高度
  //   const maxTop = 60;  // 顶部管道最大高度

  //   // 随机生成顶部管道高度
  //   const topHeight = Math.random() * (maxTop - minTop) + minTop;

  //   // 创建顶部管道
  //   const topPipe = document.createElement('div');
  //   topPipe.className = 'thirdrelaxPipe';
  //   topPipe.style.height = topHeight + '%';
  //   topPipe.style.top = '0';
  //   topPipe.style.left = '100%';
  //   topPipe.dataset.passed = 'false';
  //   topPipe.dataset.type = 'top';

  //   // 创建底部管道
  //   const bottomPipe = document.createElement('div');
  //   bottomPipe.className = 'thirdrelaxPipe';
  //   bottomPipe.style.height = (100 - topHeight - pipeGap) + '%';
  //   bottomPipe.style.bottom = '15%';
  //   bottomPipe.style.left = '100%';
  //   bottomPipe.dataset.passed = 'false';
  //   bottomPipe.dataset.type = 'bottom';

  //   gameScreen.appendChild(topPipe);
  //   gameScreen.appendChild(bottomPipe);

  //   pipes.push({
  //     top: topPipe,
  //     bottom: bottomPipe,
  //     passed: false
  //   });
  // }

  // // 移动管道
  // function movePipes() {
  //   for (let i = pipes.length - 1; i >= 0; i--) {
  //     const pipePair = pipes[i];
  //     const topPipe = pipePair.top;
  //     const bottomPipe = pipePair.bottom;

  //     // 获取管道当前位置
  //     let topLeft = parseFloat(topPipe.style.left);
  //     let bottomLeft = parseFloat(bottomPipe.style.left);

  //     // 移动管道
  //     topLeft -= 1.2; // 稍微加快管道移动速度
  //     bottomLeft -= 1.2;

  //     topPipe.style.left = topLeft + '%';
  //     bottomPipe.style.left = bottomLeft + '%';

  //     // 检测小鸟是否通过管道
  //     if (!pipePair.passed && topLeft < 20) {
  //       pipePair.passed = true;
  //       score++;
  //       scoreDisplay.textContent = score;
  //       // 得分动画
  //       scoreDisplay.style.transform = 'scale(1.2)';
  //       setTimeout(() => {
  //         scoreDisplay.style.transform = 'scale(1)';
  //       }, 200);
  //     }

  //     // 检测碰撞
  //     if (detectCollision(bird, topPipe) || detectCollision(bird, bottomPipe)) {
  //       endGame();
  //       return;
  //     }

  //     // 移除屏幕外的管道
  //     if (topLeft < -10) {
  //       topPipe.remove();
  //       bottomPipe.remove();
  //       pipes.splice(i, 1);
  //     }
  //   }
  // }

  // // 碰撞检测（优化版）
  // function detectCollision(bird, pipe) {
  //   const birdRect = bird.getBoundingClientRect();
  //   const pipeRect = pipe.getBoundingClientRect();

  //   // 使用更宽松的碰撞检测
  //   const birdPadding = 5; // 减少5px的碰撞检测范围

  //   return !(
  //     birdRect.top + birdPadding > pipeRect.bottom ||
  //     birdRect.bottom - birdPadding < pipeRect.top ||
  //     birdRect.right - birdPadding < pipeRect.left ||
  //     birdRect.left + birdPadding > pipeRect.right
  //   );
  // }

  // // 游戏结束
  // function endGame() {
  //   gameRunning = false;
  //   finalScoreDisplay.textContent = "得分: " + score;
  //   gameScreen.style.display = 'none';
  //   endScreen.style.display = 'flex';

  //   // 添加游戏结束动画
  //   bird.style.transition = 'top 0.5s';
  //   bird.style.top = '85%';

  //   setTimeout(() => {
  //     bird.style.transition = '';
  //   }, 500);
  // }

  // // 游戏主循环
  // function gameLoop() {
  //   if (!gameRunning) return;

  //   updateBird();
  //   movePipes();

  //   // 定期生成新管道
  //   frameCount++;
  //   if (frameCount % pipeInterval === 0) {
  //     createPipe();
  //   }

  //   requestAnimationFrame(gameLoop);
  // }

  // // 开始游戏
  // function startGame() {
  //   initGame();
  //   startScreen.style.display = 'none';
  //   gameScreen.style.display = 'block';
  //   endScreen.style.display = 'none';

  //   // 短暂延迟后开始游戏
  //   setTimeout(() => {
  //     gameRunning = true;
  //     gameLoop();
  //   }, 500);
  // }

  // // 页面跳转函数（示例）
  // function thirdShowPage(page) {
  //   console.log("跳转到页面: " + page);
  //   // 实际项目中这里会有页面跳转逻辑
  // }

  // // 事件监听
  // startButton.addEventListener('click', startGame);
  // restartButton.addEventListener('click', startGame);

  // // 添加点击屏幕跳跃功能
  // gameContainer.addEventListener('click', (e) => {
  //   // 避免点击按钮时触发游戏跳跃
  //   if (e.target.className !== 'thirddiamondbtn') {
  //     thirdrelaxJump();
  //   }
  // });

  // // 键盘空格键控制
  // document.addEventListener('keydown', (e) => {
  //   if (e.code === 'Space') {
  //     thirdrelaxJump();
  //   }
  // });

  // // 初始化游戏
  // initGame();

  // // 暴露跳跃函数给外部
  // window.thirdrelaxJump = thirdrelaxJump;
















  //第四页
  let forthInterval = null;
  let forthProgress = 0;
  function runForthAnimation() {
    const wrapper = document.getElementById('forthmain'); // 最外层容器
    wrapper.style.display = 'block';                      // 先显示，才能做动画
    requestAnimationFrame(() => wrapper.classList.add('animate-forth'));
  }
  function runMoodModalAnimation() {
    const modal = document.getElementById('forthMoodModal');
    modal.style.display = 'flex';               // 先让元素出现
    requestAnimationFrame(() => modal.classList.add('animate-mood'));
  }

  function forthResetPage() {
    forthreturn()
    /* 1. 把主页面关掉 */

    document.getElementById('forthmain').style.display = 'none';
    runMoodModalAnimation()
    /* 2. 把询问层重新请回来 */
    const modal = document.getElementById('forthMoodModal');
    modal.style.display = 'flex';
    modal.style.opacity = 1;

    // 如果之前做过淡出，需要重置

    /* 3. 其余原有清零逻辑 */
    document.getElementById('forthProgressBar').style.width = '0%';
    document.getElementById('forthMusicContent').style.display = 'none';
    document.getElementById('forthSubmitBar').style.width = '0%';
    document.getElementById('forthSubmitStatus').innerText = '';
    document.querySelectorAll('input[type=radio]').forEach(el => el.checked = false);
    document.body.style.backgroundColor = '';
    clearInterval(forthInterval);
    forthProgress = 0;
  }

  function forthChooseMood(mood) {
    let color = {
      joy: '#ccffdcff',
      sad: '#cce6ff',
      anger: '#ffd6cc'
    }[mood];


    runForthAnimation()
    const modal = document.getElementById('forthMoodModal');
    modal.style.opacity = 0;



    document.getElementById('forthmain').style.display = 'block';
    document.getElementById('forthMusicContent').style.display = 'flex';
    modal.style.display = 'none';

    document.getElementById("rightforth").style.backgroundColor = color
    document.getElementById("right").style.backgroundColor = color

    if (mood == "joy") {
      document.getElementById("forthmain").style.backgroundColor = "#00ff4c38"
      document.getElementById("forthProgressBar").style.backgroundColor = "#54ff41a9"
      document.getElementById("ilikeit").style.backgroundColor = "#48ff7947"
      document.getElementById("idontlikeit").style.backgroundColor = "#70ff483e"
      document.getElementById("forthControls").style.backgroundColor = "#00ff662f"
      document.getElementById("forthMainMusic").style.backgroundColor = "#40ff1a45"
      document.getElementById("forthMusicList").style.backgroundColor = "#31ff572d"
      document.getElementById("forthMusicOptions").style.backgroundColor = "#abefc790"
      document.getElementById("forthmusicul").style.backgroundColor = "#fff1f17d"
      document.getElementById("yourlikeul").style.backgroundColor = "#76ff273c"
      var li1 = document.getElementsByClassName("forthmainmusicli")
      for (var i = 0; i < li1.length; i++) {
        li1[i].style.backgroundColor = "#15ffa13c"
      }
      var li2 = document.getElementsByClassName("yourlikeli")
      for (var i = 0; i < li2.length; i++) {
        li2[i].style.backgroundColor = "#9aff671c"
      }
      document.getElementById("forthmusictile").style.backgroundColor = "#2ec30025"
      var li3 = document.getElementsByClassName("forthbutton")
      for (var i = 0; i < li3.length; i++) {
        li3[i].style.backgroundColor = "#97ffb654"
      }
      document.getElementById("forthmusicoptiondiv").style.border = "5px solid #3fff4c3c"
      document.getElementById("forthmusicul").style.border = "8px solid #b1ff8137"
    }
    else if (mood == "sad") {
      document.getElementById("forthmain").style.backgroundColor = "#00a6ff44"
      document.getElementById("forthProgressBar").style.backgroundColor = "#41dcffc3"
      document.getElementById("ilikeit").style.backgroundColor = "#48b3ffa3"
      document.getElementById("idontlikeit").style.backgroundColor = "#48c5ff56"
      document.getElementById("forthControls").style.backgroundColor = "#00eeff48"
      document.getElementById("forthMainMusic").style.backgroundColor = "#1affe445"
      document.getElementById("forthMusicList").style.backgroundColor = "#31c5ff35"
      document.getElementById("forthMusicOptions").style.backgroundColor = "#abb7ef82"
      document.getElementById("forthmusicul").style.backgroundColor = "#8be2ff77"
      document.getElementById("yourlikeul").style.backgroundColor = "#27a1ff41"
      var li1 = document.getElementsByClassName("forthmainmusicli")
      for (var i = 0; i < li1.length; i++) {
        li1[i].style.backgroundColor = "#6715ff47"
      }
      var li2 = document.getElementsByClassName("yourlikeli")
      for (var i = 0; i < li2.length; i++) {
        li2[i].style.backgroundColor = "#67fffc40"
      }
      document.getElementById("forthmusictile").style.backgroundColor = "#1a00c325"
      var li3 = document.getElementsByClassName("forthbutton")
      for (var i = 0; i < li3.length; i++) {
        li3[i].style.backgroundColor = "#97ffe282"
      }
      var li4 = document.getElementsByClassName("styled-button")
      for (var i = 0; i < li4.length; i++) {
        li4[i].style.backgroundColor = "#97ffe282"
      }
      document.getElementById("forthmusicoptiondiv").style.border = "5px solid #3f4fff69"
      document.getElementById("forthmusicul").style.border = "8px solid rgba(0, 4, 255, 0.26)"
    }
    else if (mood == "anger") {
      document.getElementById("forthmain").style.backgroundColor = "#ff59002f"
      document.getElementById("forthProgressBar").style.backgroundColor = "#ff9d4146"
      document.getElementById("ilikeit").style.backgroundColor = "#ffcb482b"
      document.getElementById("idontlikeit").style.backgroundColor = "#ffcb483d"
      document.getElementById("forthControls").style.backgroundColor = "#ff990045"
      document.getElementById("forthMainMusic").style.backgroundColor = "#ff631a33"
      document.getElementById("forthMusicList").style.backgroundColor = "#ffa63130"
      document.getElementById("forthMusicOptions").style.backgroundColor = "#efb4ab48"
      document.getElementById("forthmusicul").style.backgroundColor = "rgba(255, 236, 214, 0.4)"
      document.getElementById("yourlikeul").style.backgroundColor = "#ff97272f"
      var li1 = document.getElementsByClassName("forthmainmusicli")
      for (var i = 0; i < li1.length; i++) {
        li1[i].style.backgroundColor = "#ffb91539"
      }
      var li2 = document.getElementsByClassName("yourlikeli")
      for (var i = 0; i < li2.length; i++) {
        li2[i].style.backgroundColor = "#ff67a140"
      }
      document.getElementById("forthmusictile").style.backgroundColor = "#c3850025"
      var li3 = document.getElementsByClassName("forthbutton")
      for (var i = 0; i < li3.length; i++) {
        li3[i].style.backgroundColor = "#ffd09750"
      }
      var li4 = document.getElementsByClassName("styled-button")
      for (var i = 0; i < li4.length; i++) {
        li4[i].style.backgroundColor = "#ffbd973a"
      }
      document.getElementById("forthmusicul").style.border = "8px solid #ffb38154"
      document.getElementById("forthmusicoptiondiv").style.border = "5px solid #ff8f3f54"
    }


  }

  function forthStartProgressBar() {
    clearInterval(forthInterval);
    forthInterval = setInterval(() => {
      if (forthProgress >= 110) {
        clearInterval(forthInterval);
        return;
      }
      forthProgress++;
      document.getElementById('forthProgressBar').style.width = forthProgress + '%';
    }, 1000);
  }
  var changeplayimg = 0
  document.getElementById('forthPlayPauseBtn').onclick = () => {
    changeforthplayimg()
    if (forthInterval) {
      clearInterval(forthInterval);
      forthInterval = null;
    } else {
      forthStartProgressBar();
    }
  };
  for (var i = 0; i < document.getElementsByClassName("musicgoimggoing").length; i++) {
    document.getElementsByClassName('musicgoimggoing')[i].onclick = () => {
      forthProgress = 0;
      document.getElementById('forthProgressBar').style.width = '0%';
      forthStartProgressBar();
      if (changeplayimg % 2 == 0) {
        changeforthplayimg()
      }
      musicgo()
    }

  }
  let currentState = "none";

  function like() {
    const likeDiv = document.getElementById("ilikeit");
    const dislikeDiv = document.getElementById("idontlikeit");

    if (currentState === "like") {
      // 取消喜欢
      likeDiv.style.backgroundImage = "url(./src/24.png)";
      likeDiv.style.backgroundColor = "#fffffffe";
      likeDiv.textContent = "喜欢这首";
      currentState = "none";
    } else if (currentState === "dislike") {
      if (confirm("您方才的不喜欢是试探吗，现在将此首标记为喜欢吗？")) {
        // 取消不喜欢 → 喜欢
        dislikeDiv.style.backgroundImage = "url(./src/34.png)";
        dislikeDiv.style.backgroundColor = "#fffffffe";
        dislikeDiv.textContent = "不喜欢这首";

        likeDiv.style.backgroundImage = "url(./src/25.png)";
        likeDiv.style.backgroundColor = "#ff60cdab";
        likeDiv.textContent = "喜欢！";
        currentState = "like";
      } else {
        alert("好的，不要调皮噢");
      }
    } else {

      likeDiv.style.backgroundImage = "url(./src/25.png)";
      likeDiv.style.backgroundColor = "#ff60cdab";
      likeDiv.textContent = "喜欢！";
      currentState = "like";
    }
  }

  function dislike() {
    const likeDiv = document.getElementById("ilikeit");
    const dislikeDiv = document.getElementById("idontlikeit");

    if (currentState === "dislike") {

      dislikeDiv.style.backgroundImage = "url(./src/34.png)";
      dislikeDiv.style.backgroundColor = "#fffffffe";
      dislikeDiv.textContent = "不喜欢这首";
      currentState = "none";
    } else if (currentState === "like") {
      if (confirm("您确定您是真的不喜欢这首吗？现在取消对其的喜欢并标记为不喜欢了吗？")) {

        likeDiv.style.backgroundImage = "url(./src/24.png)";
        likeDiv.style.backgroundColor = "#fffffffe";
        likeDiv.textContent = "喜欢这首";

        dislikeDiv.style.backgroundImage = "url(./src/35.png)";
        dislikeDiv.style.backgroundColor = "#87878780";
        dislikeDiv.textContent = "不喜欢！";
        currentState = "dislike";
      } else {
        alert("明白了，真拿你没办法~");
      }
    } else {

      dislikeDiv.style.backgroundImage = "url(./src/35.png)";
      dislikeDiv.style.backgroundColor = "#87878780";
      dislikeDiv.textContent = "不喜欢！";
      currentState = "dislike";
    }
  }




  for (var i = 0; i < document.getElementsByClassName("yourlikeli").length; i++) {
    document.getElementsByClassName('yourlikeli')[i].onclick = () => {
      forthProgress = 0;
      document.getElementById('forthProgressBar').style.width = '0%';
      forthStartProgressBar();
      if (changeplayimg % 2 == 0) {
        changeforthplayimg()
      }
      likemusicgo()
    }
  }

  document.getElementById('forthPrevBtn').onclick = () => {
    forthProgress = 0;
    document.getElementById('forthProgressBar').style.width = '0%';
    forthStartProgressBar();
    if (changeplayimg % 2 == 0) {
      changeforthplayimg()
    }
  };

  document.getElementById('forthNextBtn').onclick = () => {
    forthProgress = 0;
    document.getElementById('forthProgressBar').style.width = '0%';
    forthStartProgressBar();
    if (changeplayimg % 2 == 0) {
      changeforthplayimg()
    }
  };



  function musicgo() {
    if (changeplayimg % 2 == 0) {
      changeforthplayimg()
    }
    var k = document.getElementById("forthMusicCover")
    k.style.backgroundImage = "url(./src/33.jpg)"
  }
  function likemusicgo() {
    if (changeplayimg % 2 == 0) {
      changeforthplayimg()
    }
    var k = document.getElementById("forthMusicCover")
    k.style.backgroundImage = "url(./src/32.jpg)"
  }
  function thatisgood(n) {
    var img = document.getElementsByClassName("musicgoimg")[n]
    if (img.src.endsWith("22.png")) {
      img.src = "./src/23.png";
    } else {
      img.src = "./src/22.png";
    }
  }
  function ilikeit(n) {
    const img = document.getElementsByClassName("musicgoimg")[n];
    if (img.src.endsWith("24.png")) {
      img.src = "./src/25.png";
    } else {
      img.src = "./src/24.png";
    }
  }
  var musicpic1 = "./src/26.jpg"
  var musicpic2 = "./src/27.jpg"
  var musicpic3 = "./src/28.jpg"
  var musicpic4 = "./src/29.jpg"
  var musicpic5 = "./src/30.jpg"
  var musicpic6 = "./src/31.jpg"
  var musicimg = [musicpic1, musicpic2, musicpic3, musicpic4, musicpic5, musicpic6]
  function optionmusic(n) {
    forthProgress = 0;
    var k = document.getElementById("forthMusicCover")
    k.style.backgroundImage = "url(" + musicimg[n] + ")"
    document.getElementById('forthProgressBar').style.width = '0%';
    forthStartProgressBar();
    if (changeplayimg % 2 == 0) {
      changeforthplayimg()
    }
  }





  function forthSubmitEvaluation() {
    const q1 = document.querySelector('input[name=forthQ1]:checked');
    const q2 = document.querySelector('input[name=forthQ2]:checked');
    const q3 = document.querySelector('input[name=forthQ3]:checked');
    if (!q1 || !q2 || !q3) {
      alert('请完成评价！');
      return;
    }
    let percent = 0;
    let bar = document.getElementById('forthSubmitBar');
    let status = document.getElementById('forthSubmitStatus');
    bar.style.width = '0%';
    status.innerText = '';
    let timer = setInterval(() => {
      percent += 10;
      bar.style.width = percent + '%';
      if (percent >= 100) {
        clearInterval(timer);
        status.innerText = '提交成功！';
      }
    }, 50);
  }

  function forthEndSession() {
    if (confirm('即将结束本次疗愈')) {
      forthResetPage();
    }
    else return
  }

  // 页面载入或切换回来时可手动调用这个函数以重置状态


  function changeforthplayimg() {
    var k = document.getElementById("forthPlayPauseBtn")
    if (changeplayimg % 2 == 0) {
      k.style.backgroundImage = "url(./src/17.png)"
    }
    else {
      k.style.backgroundImage = "url(./src/18.png)"
    }
    changeplayimg += 1
  }

  function forthshowquestion() {
    var a = document.getElementById("forthmain")
    var b = document.getElementById("forthend")
    a.style.display = "none"
    b.style.display = "flex"
  }
  function forthreturn() {
    var a = document.getElementById("forthmain")
    var b = document.getElementById("forthend")
    b.style.display = "none"
    a.style.display = "block"
  }


  /*第五页 */
  /*日历 */
  document.addEventListener("DOMContentLoaded", function () {
    const dateInput = document.getElementById("fifthDatePicker");
    const yearMonthDisplay = document.getElementById("fifthDateInfo");
    const dayDisplay = document.getElementById("fifthDateNumber");

    dateInput.addEventListener("change", function () {
      if (!this.value) return;

      const selectedDate = new Date(this.value);
      const year = selectedDate.getFullYear();
      const month = selectedDate.getMonth() + 1; // 月份从0开始
      const day = selectedDate.getDate();

      yearMonthDisplay.textContent = `${year}年${month}月`;
      dayDisplay.textContent = `${day}`;
    });
  });

  function fifthmain(n) {
    var a = document.getElementsByClassName("fifthmainsecondimg")
    var b = document.getElementsByClassName("rightfifthmainitem")
    var c = document.getElementsByClassName("fifthSection")
    for (var i = 0; i < a.length; i++) {
      a[i].style.opacity = 0
    }
    for (var i = 0; i < b.length; i++) {
      b[i].style.backgroundColor = "#ffffff"
    }
    for (var i = 0; i < c.length; i++) {
      c[i].style.display = "none"
    }
    a[n].style.opacity = 1
    b[n].style.backgroundColor = "#adc4ff"
    c[n].style.display = "block"
    var op = document.getElementById("fifthEmotionTrack")
    if (n == 3) {
      op.style.display = "block"
    }
    var d = document.getElementsByClassName("fifthcanvas")
    var e = document.getElementsByClassName("fifthSectionchart")
    for (var i = 0; i < 3; i++) {

      d[i].style.display = "none"
      e[i].style.display = "none"
    }
    showButtons()

  }

  function fifthgotoimg(n) {
    var k = document.getElementById("fifthTrendCharts")
    k.style.display = "none"
    var op = document.getElementsByClassName("fifthSectionchart")[n]
    var sb = document.getElementsByClassName("fifthcanvas")[n]
    op.style.display = "block"
    sb.style.display = "block"
    if (n == 0) {
      fifthLineChart.reset()
      fifthLineChart.update()

    }
    else if (n == 1) {
      fiftharea.reset()
      fiftharea.update()
    }
    showButtons()

  }

  function fifthBackToTrend(n) {
    var k = document.getElementsByClassName("fifthSectionchart")
    for (var i = 0; i < 3; i++) {
      k[n].style.display = "none"
    }

    var sb = document.getElementsByClassName("fifthcanvas")
    for (var i = 0; i < 3; i++) {
      sb[n].style.display = "none"
    }
    var a = document.getElementById("fifthTrendCharts")
    a.style.display = "block"
    showButtons()
  }

  function showButtons() {
    const fifthBtns = document.querySelectorAll(".fifthButton");
    const returnBtns = document.querySelectorAll(".fifthButtonreturn");

    const animate = (elements, animationClass) => {
      elements.forEach(el => {
        el.classList.remove(animationClass);    // 移除旧动画类
        void el.offsetWidth;                    // 强制重绘，重触发动画
        el.classList.add(animationClass);       // 添加动画类
      });
    };

    animate(fifthBtns, "fifthButtonAnimation");
    animate(returnBtns, "fifthButtonreturnAnimation");
  }

  function fifthShowAnimation() {
    // 所有需要动画的盒子选择器
    const selectors = [
      "#rightfifthtitle",
      "#rightfifthbook",
      "#rightfifthmain",
      "#rightfifthable .fifthSection",
      "#rightfifthable .fifthSectionchart",
      "#user2"
    ];

    // 清除旧动画（便于重复触发）
    document.querySelectorAll(".fifth-animate-in").forEach(el => {
      el.classList.remove("fifth-animate-in");
    });

    // 为匹配的元素依次添加动画类（可加入延时效果）
    selectors.forEach(selector => {
      const elements = document.querySelectorAll(selector);
      elements.forEach((el, index) => {
        // 设置延迟，避免所有同时进入
        setTimeout(() => {
          el.classList.add("fifth-animate-in");
        }, index * 100);
      });
    });
  }














































  //横向图
  const ctx = document.getElementById('rightfirstmainleftchart').getContext('2d');

  const emotionBar = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: [
        '情绪稳定程度',
        '接受情绪调频效果',
        '音乐疗愈效果',
        '进行情绪记录的连续性'
      ],
      datasets: [{
        label: '评估值',
        data: [35, 79, 58, 91],
        backgroundColor: [
          '#4CAF50',
          '#2196F3',
          '#FF9800',
          '#9C27B0'
        ],
        borderRadius: 6,
        barThickness: 24
      }]
    },
    options: {
      responsive: true,
      indexAxis: 'y',
      plugins: {
        legend: {
          display: false
        },
        title: {
          display: true,
          text: '个人情绪指标图',
          font: {
            size: 18
          }
        },
        tooltip: {
          callbacks: {
            label: (context) => {
              const label = context.label;
              const value = context.raw;
              return `${label}: ${value} 分`;
            }
          }
        }
      },
      scales: {
        x: {
          min: 0,
          max: 100,
          title: {
            display: true,
            text: '百分制数值'
          },
          ticks: {
            callback: function (value) {
              return value + '%';
            }
          }
        },
        y: {
          title: {
            display: false
          }
        }
      }
    }
  });


  const ctx1 = document.getElementById('chart');
  const emothionline = new Chart(ctx1, {
    type: 'line',
    data: {
      labels: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
      datasets: [
        { label: '愉悦', data: [85, 49, 80, 99, 56, 25, 2], borderColor: '#ff6b6b', backgroundColor: 'transparent', tension: .4 },
        { label: '平静', data: [69, 50, 81, 86, 55, 20, 15], borderColor: '#4ecdc4', backgroundColor: 'transparent', tension: .4 },
        { label: '焦虑', data: [23, 84, 12, 45, 23, 80, 91], borderColor: '#ffa726', backgroundColor: 'transparent', tension: .4 }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      interaction: { mode: 'index', intersect: false },
      plugins: {
        legend: { display: false },
        tooltip: {
          callbacks: {
            title: t => t[0].label
          }
        }
      },
      scales: {
        y: { beginAtZero: true, max: 100, ticks: { stepSize: 20 } },
        x: { grid: { display: false } }
      }
    }
  });

  const ctx2 = document.getElementById('emotionPie').getContext('2d');

  const emotionDescriptions = {
    '喜悦': '周一与老友聚会；周四终于完成所有大作业',
    '平静': '这周大部分时间都如平常一般淡如水',
    '悲伤': '周三被三叶与泷的故事而感动；周六得知还有一个大作业没写完',
    '愤怒': '周二被高数难生气了',
    '混乱': '所有事情都不是只有一个情绪，其中的很多都还无法确定……'
  };

  const emotionPie = new Chart(ctx2, {
    type: 'pie',
    data: {
      labels: ['喜悦', '平静', '悲伤', '愤怒', '混乱'],
      datasets: [{
        label: '本周情绪构成',
        data: [28, 42, 11, 9, 10],
        backgroundColor: [
          '#FFD700',  // 喜悦
          '#87CEFA',  // 平静
          '#A9A9A9',  // 悲伤
          '#FF6347',  // 愤怒
          '#9370DB'   // 混乱
        ],
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      plugins: {
        tooltip: {
          callbacks: {
            label: function (context) {
              const label = context.label;
              const value = context.raw;
              const description = emotionDescriptions[label] || '';
              return `${label}: ${value}%\n说明：${description}`;
            }
          }
        },
        legend: {
          position: 'bottom'
        },
        title: {
          display: true,
          text: '本周情绪组成（百分比）',
          font: {
            size: 18
          }
        }
      }
    }
  });

  const ctx3 = document.getElementById('emotionhistory').getContext('2d');

  const emotionChart = new Chart(ctx3, {
    type: 'bar',
    data: {
      labels: ['快乐', '愤怒', '悲伤', '焦虑', '复杂'],
      datasets: [{
        label: '识别次数',
        data: [58, 42, 64, 12, 38],
        backgroundColor: [
          'rgba(255, 206, 86, 0.6)',   // 快乐
          'rgba(255, 99, 132, 0.6)',   // 愤怒
          'rgba(54, 162, 235, 0.6)',   // 悲伤
          'rgba(153, 102, 255, 0.6)',  // 焦虑
          'rgba(75, 192, 192, 0.6)'    // 复杂
        ],
        borderColor: [
          'rgba(255, 206, 86, 1)',
          'rgba(255, 99, 132, 1)',
          'rgba(54, 162, 235, 1)',
          'rgba(153, 102, 255, 1)',
          'rgba(75, 192, 192, 1)'
        ],
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      scales: {
        y: {
          beginAtZero: true,
          title: {
            display: true,
            text: '次数'
          }
        },
        x: {
          title: {
            display: true,
            text: '情绪种类'
          }
        }
      },
      plugins: {
        title: {
          display: true,
          text: '历史情绪识别记录'
        },
        legend: {
          display: false
        }
      }
    }
  });


  /*第五页 */




  const fifthLineData = {
    labels: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
    datasets: [
      {
        label: '喜',
        data: Array.from({ length: 7 }, () => Math.floor(Math.random() * 50 + 50)),
        borderColor: 'green',
        tension: 0.4
      },
      {
        label: '悲',
        data: Array.from({ length: 7 }, () => Math.floor(Math.random() * 50 + 10)),
        borderColor: 'blue',
        tension: 0.4
      },
      {
        label: '怒',
        data: Array.from({ length: 7 }, () => Math.floor(Math.random() * 50 + 20)),
        borderColor: 'red',
        tension: 0.4
      }
    ]
  };
  const fifthLineChart = new Chart(document.getElementById('fifthLineChart'), {
    type: 'line',
    data: fifthLineData,
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        y: {
          min: 0,
          max: 100
        }
      }
    }
  });

  const json = [
    { date: '周一', pos: 0.3, neu: 0.4, neg: 0.3 },
    { date: '周二', pos: 0.4, neu: 0.3, neg: 0.3 },
    { date: '周三', pos: 0.2, neu: 0.5, neg: 0.3 },
    { date: '周四', pos: 0.5, neu: 0.3, neg: 0.2 },
    { date: '周五', pos: 0.3, neu: 0.5, neg: 0.2 },
    { date: '周六', pos: 0.6, neu: 0.2, neg: 0.2 },
    { date: '周日', pos: 0.5, neu: 0.3, neg: 0.2 }
  ];
  const fiftharea = new Chart(document.getElementById('stackedArea'), {
    type: 'line',
    data: {
      labels: json.map(d => d.date),
      datasets: [
        {
          label: 'Pos',
          data: json.map(d => d.pos * 100),
          backgroundColor: '#4ADE80',
          fill: true,
          tension: 0.3
        },
        {
          label: 'Neu',
          data: json.map(d => (d.pos + d.neu) * 100),
          backgroundColor: '#60A5FA',
          fill: '-1',
          tension: 0.3
        },
        {
          label: 'Neg',
          data: json.map(d => 100),
          backgroundColor: '#F87171',
          fill: '-1',
          tension: 0.3
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        y: {
          stacked: true,
          beginAtZero: true,
          max: 100,
          ticks: {
            callback: v => v + '%'
          }
        },
        x: {
          grid: { display: false }
        }
      },
      plugins: {
        legend: { position: 'top' },
        tooltip: {
          mode: 'index',
          intersect: false,
          callbacks: {
            label: ctx => `${ctx.dataset.label}: ${ctx.raw.toFixed(0)}%`
          }
        }
      }
    }
  });





  /*日历热力图 */
  /* ---------- 1. 本地存储 ---------- */
  const LS_KEY = 'mood2026';
  function loadData() { return JSON.parse(localStorage.getItem(LS_KEY) || '{}'); }
  function saveData(d) { localStorage.setItem(LS_KEY, JSON.stringify(d)); }
  let DATA = loadData();

  /* ---------- 2. 常量 ---------- */
  const YEAR = 2026;
  const first = new Date(YEAR, 0, 1);
  const start = new Date(first);
  start.setDate(first.getDate() - first.getDay()); // 周日开头
  const weeks = 53;

  /* ---------- 3. 画日历 ---------- */
  const svg = document.getElementById('cal');
  const cell = 1000 / weeks / 1.15;   // 一格宽度
  const gap = cell * 0.15;
  const h = cell * 7 + 20;
  svg.setAttribute('viewBox', `0 0 1000 ${h}`);
  svg.innerHTML = '';

  /* 星期文字 */
  ['日', '一', '二', '三', '四', '五', '六'].forEach((txt, i) => {
    const t = document.createElementNS('http://www.w3.org/2000/svg', 'text');
    t.textContent = txt;
    t.setAttribute('x', 0);
    t.setAttribute('y', 15 + i * (cell + gap));
    t.setAttribute('class', 'wday');
    svg.appendChild(t);
  });

  /* 生成格子 */
  const rects = new Map();   // date -> rect
  for (let w = 0; w < weeks; w++) {
    for (let d = 0; d < 7; d++) {
      const date = new Date(start);
      date.setDate(start.getDate() + w * 7 + d);
      if (date.getFullYear() !== YEAR) continue;

      const key = date.toISOString().slice(0, 10);
      const x = 20 + w * (cell + gap);
      const y = 3 + d * (cell + gap);

      const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
      rect.setAttribute('x', x);
      rect.setAttribute('y', y);
      rect.setAttribute('width', cell);
      rect.setAttribute('height', cell);
      rect.dataset.date = key;
      setRectClass(rect, DATA[key]?.score);
      svg.appendChild(rect);
      rects.set(key, rect);
    }
  }

  function setRectClass(rect, score) {
    if (score === undefined) {
      rect.setAttribute('class', 'none');
    } else {
      const c = score <= 1 ? 'l0' : score <= 2 ? 'l1' : score <= 3 ? 'l2' : score <= 4 ? 'l3' : 'l4';
      rect.setAttribute('class', c);
    }
  }

  /* ---------- 4. 弹窗 ---------- */
  const dlg = document.getElementById('dlg');
  const dlgTitle = document.getElementById('dlgTitle');
  const dlgDate = document.getElementById('dlgDate');
  const scoreSel = document.getElementById('scoreSel');
  const noteTxt = document.getElementById('noteTxt');
  const saveBtn = document.getElementById('save');
  const delBtn = document.getElementById('del');
  const cancelBtn = document.getElementById('cancel');

  let curDate = null;

  function openDialog(dateStr, isEdit = false) {
    curDate = dateStr;
    dlg.classList.remove('hidden');
    dlgDate.textContent = dateStr;
    if (isEdit) {
      dlgTitle.textContent = '编辑记录';
      const { score, note } = DATA[dateStr];
      scoreSel.value = score;
      noteTxt.value = note || '';
      delBtn.classList.remove('hidden');
    } else {
      dlgTitle.textContent = '新增记录';
      scoreSel.value = 3;
      noteTxt.value = '';
      delBtn.classList.add('hidden');
    }
  }
  function closeDialog() {
    dlg.classList.add('hidden');
    curDate = null;
  }

  /* 事件 */
  svg.addEventListener('click', e => {
    if (e.target.tagName !== 'rect') return;
    const date = e.target.dataset.date;
    DATA[date] ? openDialog(date, true) : openDialog(date, false);
  });
  saveBtn.onclick = () => {
    const score = +scoreSel.value;
    const note = noteTxt.value.trim();
    DATA[curDate] = { score, note };
    saveData(DATA);
    setRectClass(rects.get(curDate), score);
    closeDialog();
  };
  delBtn.onclick = () => {
    delete DATA[curDate];
    saveData(DATA);
    setRectClass(rects.get(curDate), undefined);
    closeDialog();
  };
  cancelBtn.onclick = closeDialog;
  function jumpToDate() {
    const val = document.getElementById('datePicker').value;
    if (!val) { alert('请选择日期'); return; }
    const rect = rects.get(val);
    if (!rect) { alert('该日期不在 2026 年范围内'); return; }


    rect.scrollIntoView({ behavior: 'smooth', block: 'center' });


    rect.classList.add('jump-flash');
    setTimeout(() => rect.classList.remove('jump-flash'), 1000);

    setTimeout(() => rect.dispatchEvent(new Event('click')), 600);
  }


</script>

</html>